import{j as e}from"./markdown-BUCLRvA3.js";import{a as d,H as B}from"./vendor-BlctNO3C.js";import{A as M}from"./AdminLayout-BSGNemk3.js";import{u as F,a as J}from"./app-CTYxS4-K.js";import{I as m}from"./Icon-D4dftWJa.js";import{m as y}from"./proxy-lxAKZ2WZ.js";import"./index-DMt_lOXb.js";import"./Footer-CsMuwlAl.js";import"./app-gPlgxhTc.js";const ne=({footerSettings:P,currentVersion:T,updateAvailable:W,latestVersion:p,lastUpdated:k})=>{const h=F(),{isDarkMode:K}=J(),[b,N]=d.useState(!1),[S,i]=d.useState([]),[a,o]=d.useState("idle"),[q,u]=d.useState(0),[Y,V]=d.useState(null),[z,Z]=d.useState(null),[f,U]=d.useState([]),[j,X]=d.useState(0),[R,C]=d.useState([]),H=["üîß Maintenance modu aktivl…ô≈üdirilir...","üì¶ Veril…ônl…ôr bazasƒ± backup edilir...","‚¨áÔ∏è Yenilik fayllarƒ± endirilir...","üìÇ Fayllar √ßƒ±xardƒ±lƒ±r v…ô k√∂√ß√ºr√ºl√ºr...","üóÑÔ∏è Veril…ônl…ôr bazasƒ± yenil…ônir...","üßπ Cache t…ômizl…ônir...","üìö Dependencies yenil…ônir...","üîß Cache yenid…ôn qurulur...","üîó Storage linkl…ôr yenil…ônir...","üìù Versiya m…ôlumatlarƒ± yenil…ônir...","üü¢ Sayt yenid…ôn aktiv edilir..."],A=async()=>{try{const s=await(await fetch("/admin/system/update-history",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",redirect:"follow"})).text();let r;try{r=JSON.parse(s)}catch{throw new Error("Tarix JSON deyil. "+s.slice(0,200))}if(r?.success&&Array.isArray(r.items))C(r.items);else throw new Error(r?.message||"Bilinm…ôy…ôn x…ôta")}catch(t){i(s=>[...s,"‚ö†Ô∏è Tarix y√ºkl…ônm…ô x…ôtasƒ±: "+t.message])}},D=async()=>{o("checking"),i(["üîç Yenilikl…ôr yoxlanƒ±lƒ±r..."]),u(0);try{const t=await fetch("/admin/system/check-updates",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",redirect:"follow"}),s=await t.text();let r;try{r=JSON.parse(s)}catch{throw new Error((t.redirected?"Y√∂nl…ôndirm…ô ba≈ü verdi. ":"")+(s?s.slice(0,200):"Server JSON qaytarmadƒ±."))}if(r.success)r.has_update?(i(n=>[...n,`üÜï Yeni versiya m√∂vcuddur! v${r.latest_version}`]),r.release_notes&&i(n=>[...n,`üìù D…ôyi≈üiklikl…ôr: ${r.release_notes.slice(0,100)}...`]),o("update-available"),U(H),window.updateDownloadUrl=r.download_url):(i(n=>[...n,"‚úÖ Skriptiniz son versiyadƒ±r!"]),o("up-to-date"));else throw new Error(r.message||"Bilinm…ôy…ôn x…ôta")}catch(t){i(s=>[...s,"‚ùå Yoxlama x…ôtasƒ±: "+t.message]),o("error")}},_=async()=>{if(confirm(`Sistem yenil…ôm…ôy…ô ba≈ülayacaq. Bu proses 2-5 d…ôqiq…ô √ß…ôk…ô bil…ôr.

Davam etm…ôk ist…ôyirsiniz?`)){if(!window.updateDownloadUrl){h.error("Download URL tapƒ±lmadƒ±. ∆èvv…ôlc…ô yenilikl…ôr yoxlayƒ±n.");return}N(!0),o("updating"),i(["‚ü≥ Sistem yenil…ônm…ôsi ba≈ülandƒ±..."]),u(0),X(0);try{const t=setInterval(async()=>{try{const x=await(await fetch("/admin/system/update-log",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json();if(x.log){const v=x.log.split(`
`).filter(w=>w.trim());i(v)}}catch{}},1e3),s=document.querySelector('meta[name="csrf-token"]'),r=s?s.getAttribute("content"):null,n=document.cookie.split("; ").find(l=>l.startsWith("XSRF-TOKEN=")),E=n?decodeURIComponent(n.split("=")[1]):null,g=await fetch("/admin/system/perform-update",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/plain, application/json","X-Requested-With":"XMLHttpRequest",...r?{"X-CSRF-TOKEN":r}:{},...E?{"X-XSRF-TOKEN":E}:{}},credentials:"same-origin",body:JSON.stringify({download_url:window.updateDownloadUrl})});if(g.status===419)throw new Error("Sessiya vaxtƒ± bitdi (419). S…ôhif…ôni yenil…ôyib yenid…ôn c…ôhd edin.");const L=g.body?.getReader(),O=new TextDecoder("utf-8");let c="";if(L)for(;;){const{done:l,value:x}=await L.read();if(l)break;const v=O.decode(x,{stream:!0});c+=v;const w=c.split(`
`).filter(I=>I.trim());i(w)}else{c=await g.text();const l=c.split(`
`).filter(x=>x.trim());i(l)}clearInterval(t);const $=/‚úÖ\s*Sistem uƒüurla yenil…ôndi!/u.test(c)||/Yenil…ôm…ô tamamlandƒ±/i.test(c);if(g.ok&&$)u(100),o("completed"),i(l=>[...l,"‚úì Sistem uƒüurla yenil…ôndi!"]),h.success("Sistem uƒüurla yenil…ôndi!"),await A(),setTimeout(()=>{window.location.reload()},3e3);else{const l=c.split(`
`).slice(-5).join(`
`);throw new Error(l||"Bilinm…ôy…ôn x…ôta")}}catch(t){i(s=>[...s,"‚ùå Yenil…ôm…ô x…ôtasƒ±: "+t.message]),o("error"),u(0),h.error("Yenil…ôm…ô uƒüursuz oldu!")}finally{N(!1)}}};return d.useEffect(()=>{D(),A()},[]),e.jsxs(M,{children:[e.jsx(B,{title:"Sistem Yenilikl…ôri"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:[e.jsx(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 mb-8 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-3",children:[e.jsx(m,{name:"settings",size:32,color:"#10b981"}),"Sistem Yenil…ôm…ôl…ôri"]}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:"Sistemi yeni versiyaya yenil…ôyin"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:["Cari Versiya: v",T]}),p&&e.jsxs("div",{className:"text-sm text-green-600 dark:text-green-400",children:["Son Versiya: v",p]}),k&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Son yenil…ônm…ô: ",new Date(k).toLocaleDateString("az-AZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-6 flex items-center gap-2",children:[e.jsx(m,{name:"settings",size:20}),"ƒ∞dar…ô Paneli"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Sistem Statusu"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a==="checking"&&"üîç Yoxlanƒ±r...",a==="update-available"&&`üÜï Yenil…ôm…ô var${Y?` (${Y})`:""}`,a==="up-to-date"&&"‚úì Aktual versiya",a==="updating"&&"‚ü≥ Yenil…ônir...",a==="completed"&&"‚úì Tamamlandƒ±",a==="error"&&"‚ö†Ô∏é X…ôta",a==="idle"&&"‚è≥ Hazƒ±r"]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${a==="update-available"?"bg-orange-500 animate-pulse":a==="up-to-date"||a==="completed"?"bg-green-500":a==="updating"||a==="checking"?"bg-blue-500 animate-pulse":a==="error"?"bg-red-500":"bg-gray-400"}`})]}),a==="updating"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("span",{children:"Yenil…ônm…ô t…ôr…ôqq√ºsi"}),e.jsxs("span",{children:[q,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"h-3 bg-gradient-to-r from-blue-500 to-green-500 rounded-full transition-all duration-300 ease-out relative",style:{width:`${q}%`},children:e.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse rounded-full"})})}),j<f.length&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Addƒ±m ",j+1,"/",f.length,": ",f[j]?.split(" ").slice(1).join(" ")]}),z&&e.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:["‚¨áÔ∏è Y√ºkl…ôm…ô s√ºr…ôti: ",z]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("button",{onClick:D,disabled:b||a==="checking",className:"w-full py-3 px-4 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(m,{name:"search",size:16}),a==="checking"?"Yoxlanƒ±r...":"Yenilikl…ôri Yoxla"]}),a==="update-available"&&e.jsxs("button",{onClick:_,disabled:b,className:"w-full py-3 px-4 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(m,{name:"download",size:16}),b?"Yenil…ônir...":`v${p} Yenil…ô`]})]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(m,{name:"warning",size:16,color:"#f59e0b"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Diqq…ôt"}),e.jsx("div",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsx("li",{children:"Yenilik prosesi 2-5 d…ôqiq…ô √ß…ôk…ô bil…ôr"}),e.jsx("li",{children:"Bu m√ºdd…ôtd…ô sayt …ôl√ßatan olmayacaq"}),e.jsx("li",{children:"Avtomatik backup yaradƒ±lacaq"}),e.jsx("li",{children:"Brauzer s…ôhif…ôsini baƒülamayƒ±n"})]})})]})]})})]})]}),e.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-4 flex items-center gap-2",children:[e.jsx(m,{name:"copy",size:20}),"Proses Logu"]}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 h-80 overflow-y-auto",children:e.jsx("div",{className:"font-mono text-sm space-y-1",children:S.length===0?e.jsx("div",{className:"text-gray-400",children:"Yenilik logu burada g√∂r√ºn…ôc…ôk..."}):S.map((t,s)=>e.jsx("div",{className:"text-green-400",children:t},s))})})]}),e.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-4 flex items-center gap-2",children:[e.jsx(m,{name:"history",size:20}),"Yenil…ôm…ô Tarixi"]}),R.length===0?e.jsx("div",{className:"text-gray-500",children:"H…ôl…ô he√ß bir yenil…ôm…ô qeydi tapƒ±lmadƒ±."}):e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:R.map(t=>e.jsxs("div",{className:"p-3 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-white text-xs mr-2 ${t.status==="success"?"bg-green-500":"bg-red-500"}`,children:t.status}),e.jsxs("span",{children:["v",t.version_from||"‚Äî"," ‚Üí v",t.version_to||"‚Äî"]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.created_at).toLocaleString("az-AZ")})]}),t.message&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.message})]},t.id))})]})]})]})})]})};export{ne as default};
