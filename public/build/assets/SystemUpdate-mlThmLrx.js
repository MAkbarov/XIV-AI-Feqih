import{j as e}from"./markdown-BUCLRvA3.js";import{a as d,H as B}from"./vendor-BlctNO3C.js";import{A as J}from"./AdminLayout-mQ-GXTvV.js";import{u as W,a as V}from"./app-DzPMoZkY.js";import{I as m}from"./Icon-CILp3_L4.js";import{m as f}from"./proxy-lxAKZ2WZ.js";import"./index-DMt_lOXb.js";import"./Footer-THMmidnb.js";import"./app-B0iARrZD.js";const v=E=>{const S=`; ${document.cookie}`.split(`; ${E}=`);return S.length===2?S.pop().split(";").shift():null},oe=({footerSettings:E,currentVersion:k,updateAvailable:S,latestVersion:p,lastUpdated:R})=>{const x=W(),{isDarkMode:Z}=V(),[h,q]=d.useState(!1),[A,T]=d.useState(!1),[X,i]=d.useState([]),[l,u]=d.useState("idle"),[z,b]=d.useState(0),[C,G]=d.useState(null),[U,Q]=d.useState(null),[j,F]=d.useState([]),[w,L]=d.useState(0),[N,O]=d.useState([]),H=["üîß Maintenance modu aktivl…ô≈üdirilir...","üì¶ Veril…ônl…ôr bazasƒ± backup edilir...","‚¨áÔ∏è Yenilik fayllarƒ± endirilir...","üìÇ Fayllar √ßƒ±xardƒ±lƒ±r v…ô k√∂√ß√ºr√ºl√ºr...","üóÑÔ∏è Veril…ônl…ôr bazasƒ± yenil…ônir...","üßπ Cache t…ômizl…ônir...","üìö Dependencies yenil…ônir...","üîß Cache yenid…ôn qurulur...","üîó Storage linkl…ôr yenil…ônir...","üìù Versiya m…ôlumatlarƒ± yenil…ônir...","üü¢ Sayt yenid…ôn aktiv edilir..."],Y=async()=>{try{const t=await fetch("/admin/system/update-history",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),"X-XSRF-TOKEN":v("XSRF-TOKEN")},credentials:"same-origin",redirect:"follow"});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const a=await t.text();let r;try{r=JSON.parse(a)}catch{console.warn("History API response not JSON:",a.slice(0,200));return}r?.success&&Array.isArray(r.items)?O(r.items):console.warn("History API returned invalid data:",r)}catch(t){console.warn("History loading failed:",t.message)}},D=async()=>{u("checking"),i(["üîç Yenilikl…ôr yoxlanƒ±lƒ±r..."]),b(0);try{const t=await fetch("/admin/system/check-updates",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",redirect:"follow"}),a=await t.text();let r;try{r=JSON.parse(a)}catch{throw new Error((t.redirected?"Y√∂nl…ôndirm…ô ba≈ü verdi. ":"")+(a?a.slice(0,200):"Server JSON qaytarmadƒ±."))}if(r.success)r.has_update?(i(s=>[...s,`üÜï Yeni versiya m√∂vcuddur! v${r.latest_version}`]),r.release_notes&&i(s=>[...s,`üìù D…ôyi≈üiklikl…ôr: ${r.release_notes.slice(0,100)}...`]),u("update-available"),F(H),window.updateDownloadUrl=r.download_url):(i(s=>[...s,"‚úÖ Skriptiniz son versiyadƒ±r!"]),u("up-to-date"));else throw new Error(r.message||"Bilinm…ôy…ôn x…ôta")}catch(t){i(a=>[...a,"‚ùå Yoxlama x…ôtasƒ±: "+t.message]),u("error")}},I=async()=>{if(confirm(`Sistem yenil…ôm…ôy…ô ba≈ülayacaq. Bu proses 2-5 d…ôqiq…ô √ß…ôk…ô bil…ôr.

Davam etm…ôk ist…ôyirsiniz?`)){if(!window.updateDownloadUrl){x.error("Download URL tapƒ±lmadƒ±. ∆èvv…ôlc…ô yenilikl…ôr yoxlayƒ±n.");return}q(!0),u("updating"),i(["‚ü≥ Sistem yenil…ônm…ôsi ba≈ülandƒ±..."]),b(0),L(0);try{const t=setInterval(async()=>{try{const c=await(await fetch("/admin/system/update-log",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-XSRF-TOKEN":v("XSRF-TOKEN")},credentials:"same-origin"})).json();if(c.log){const y=c.log.split(`
`).filter(g=>g.trim());i(y)}}catch{}},1e3),a=await fetch("/admin/system/perform-update",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-XSRF-TOKEN":v("XSRF-TOKEN")},credentials:"same-origin",body:JSON.stringify({download_url:window.updateDownloadUrl})}),r=a.body?.getReader(),s=new TextDecoder("utf-8");let n="";if(r)for(;;){const{done:o,value:c}=await r.read();if(o)break;const y=s.decode(c,{stream:!0});n+=y;const g=n.split(`
`).filter(K=>K.trim());i(g)}else{n=await a.text();const o=n.split(`
`).filter(c=>c.trim());i(o)}if(clearInterval(t),a.status===419)throw new Error("CSRF token uyu≈ümazlƒ±ƒüƒ±. S…ôhif…ôni yenil…ôyib yenid…ôn c…ôhd edin.");const $=/\[\[UPDATE_SUCCESS\]\]/.test(n),M=/\[\[UPDATE_FAILED\]\]/.test(n),P=$||/YENƒ∞L∆èM∆è TAMAMIL∆è UƒûURLU/i.test(n);if(a.ok&&P&&!M){const o=n.match(/\u2728\s*([0-9.]+)\s*(?:\u2192|->)\s*v?([0-9.]+)/),c=o?.[1]||k,y=o?.[2]||p||"latest";b(100),u("completed"),i(g=>[...g,`‚úì Son versiyaya m√ºv…ôff…ôqiyy…ôtl…ô yenil…ôndi! v${c} ‚Üí v${y}`]),x.success(`Son versiyaya m√ºv…ôff…ôqiyy…ôtl…ô yenil…ôndi! v${c} ‚Üí v${y}`),await Y(),setTimeout(()=>{window.location.reload()},3e3)}else{const o=n.split(`
`).slice(-5).join(`
`);throw new Error(o||"Bilinm…ôy…ôn x…ôta")}}catch(t){i(a=>[...a,"‚ùå Yenil…ôm…ô x…ôtasƒ±: "+t.message]),u("error"),b(0),x.error("Yenil…ôm…ô uƒüursuz oldu!")}finally{q(!1)}}},_=async()=>{if(confirm(`üîß SSH-free Sistem B…ôrpasƒ± ba≈ülayacaq!

Bu proses:
‚Ä¢ Migration probleml…ôrini h…ôll ed…ôc…ôk
‚Ä¢ Database strukturunu yoxlayacaq
‚Ä¢ Cache-i t…ômizl…ôy…ôc…ôk
‚Ä¢ AiService metodlarƒ±nƒ± yoxlayacaq

Davam etm…ôk ist…ôyirsiniz?`)){T(!0),i(["üîß === SSH-FREE Sƒ∞STEM B∆èRPASI BA≈ûLADI ==="]);try{const a=await(await fetch("/admin/system/fix-and-repair",{method:"POST",headers:{Accept:"text/plain","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-XSRF-TOKEN":v("XSRF-TOKEN")},credentials:"same-origin"})).text();if(a.split(`
`).filter(s=>s.trim()).forEach(s=>{i(n=>[...n,s])}),a.includes("[[REPAIR_SUCCESS]]"))i(s=>[...s,"SUCCESS: Sistem probleml…ôri h…ôll olundu!"]),i(s=>[...s,"3 saniy…ô sonra s…ôhif…ô yenil…ôn…ôc…ôk..."]),x.success("Sistem b…ôrpasƒ± uƒüurlu! S…ôhif…ô yenil…ônir..."),setTimeout(()=>{window.location.reload()},3e3);else{if(a.includes("[[REPAIR_FAILED]]"))throw new Error("Sistem b…ôrpasƒ± x…ôtalarla tamamlandƒ±");i(s=>[...s,"SUCCESS: Sistem b…ôrpasƒ± tamamlandƒ±"]),x.success("Sistem b…ôrpasƒ± tamamlandƒ±!"),setTimeout(()=>{window.location.reload()},2e3)}}catch(t){i(a=>[...a,"‚ùå Sistem b…ôrpasƒ± x…ôtasƒ±: "+t.message]),x.error("Sistem b…ôrpasƒ± uƒüursuz: "+t.message)}finally{T(!1)}}};return d.useEffect(()=>{D(),Y()},[]),e.jsxs(J,{children:[e.jsx(B,{title:"Sistem Yenilikl…ôri"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:[e.jsx(f.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 mb-8 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-3",children:[e.jsx(m,{name:"settings",size:32,color:"#10b981"}),"Sistem Yenil…ôm…ôl…ôri"]}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:"Sistemi yeni versiyaya yenil…ôyin"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:["Cari Versiya: v",k]}),p&&e.jsxs("div",{className:"text-sm text-green-600 dark:text-green-400",children:["Son Versiya: v",p]}),R&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Son yenil…ônm…ô: ",new Date(R).toLocaleDateString("az-AZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-6 flex items-center gap-2",children:[e.jsx(m,{name:"settings",size:20}),"ƒ∞dar…ô Paneli"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Sistem Statusu"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l==="checking"&&"üîç Yoxlanƒ±r...",l==="update-available"&&`üÜï Yenil…ôm…ô var${C?` (${C})`:""}`,l==="up-to-date"&&"‚úì Aktual versiya",l==="updating"&&"‚ü≥ Yenil…ônir...",l==="completed"&&"‚úì Tamamlandƒ±",l==="error"&&"‚ö†Ô∏é X…ôta",l==="idle"&&"‚è≥ Hazƒ±r"]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${l==="update-available"?"bg-orange-500 animate-pulse":l==="up-to-date"||l==="completed"?"bg-green-500":l==="updating"||l==="checking"?"bg-blue-500 animate-pulse":l==="error"?"bg-red-500":"bg-gray-400"}`})]}),l==="updating"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("span",{children:"Yenil…ônm…ô t…ôr…ôqq√ºsi"}),e.jsxs("span",{children:[z,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"h-3 bg-gradient-to-r from-blue-500 to-green-500 rounded-full transition-all duration-300 ease-out relative",style:{width:`${z}%`},children:e.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse rounded-full"})})}),w<j.length&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Addƒ±m ",w+1,"/",j.length,": ",j[w]?.split(" ").slice(1).join(" ")]}),U&&e.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:["‚¨áÔ∏è Y√ºkl…ôm…ô s√ºr…ôti: ",U]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("button",{onClick:D,disabled:h||l==="checking",className:"w-full py-3 px-4 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(m,{name:"search",size:16}),l==="checking"?"Yoxlanƒ±r...":"Yenilikl…ôri Yoxla"]}),l==="update-available"&&e.jsxs("button",{onClick:I,disabled:h,className:"w-full py-3 px-4 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(m,{name:"download",size:16}),h?"Yenil…ônir...":`v${p} Yenil…ô`]}),e.jsxs("button",{onClick:_,disabled:h||A,className:"w-full py-3 px-4 bg-orange-500 hover:bg-orange-600 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2 border-2 border-orange-300 dark:border-orange-700",title:"SSH olmadan sistem probleml…ôrini h…ôll edir",children:[e.jsx(m,{name:"tool",size:16}),A?"B…ôrpa edilir...":"üîß Fiksasiya v…ô B…ôrpa"]})]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(m,{name:"warning",size:16,color:"#f59e0b"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Diqq…ôt"}),e.jsx("div",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsx("li",{children:"Yenilik prosesi 2-5 d…ôqiq…ô √ß…ôk…ô bil…ôr"}),e.jsx("li",{children:"Bu m√ºdd…ôtd…ô sayt …ôl√ßatan olmayacaq"}),e.jsx("li",{children:"Avtomatik backup yaradƒ±lacaq"}),e.jsx("li",{children:"Brauzer s…ôhif…ôsini baƒülamayƒ±n"})]})})]})]})})]})]}),e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-4 flex items-center gap-2",children:[e.jsx(m,{name:"copy",size:20}),"Proses Logu"]}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 h-80 overflow-y-auto",children:e.jsx("div",{className:"font-mono text-sm space-y-1",children:X.length===0?e.jsx("div",{className:"text-gray-400",children:"Yenilik logu burada g√∂r√ºn…ôc…ôk..."}):X.map((t,a)=>e.jsx("div",{className:"text-green-400",children:t},a))})})]}),e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-lg rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-4 flex items-center gap-2",children:[e.jsx(m,{name:"history",size:20}),"Yenil…ôm…ô Tarixi"]}),N.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("div",{className:"text-gray-400 dark:text-gray-500 mb-2",children:[e.jsx(m,{name:"history",size:48,className:"mx-auto mb-3 opacity-50"}),"H…ôl…ô he√ß bir yenil…ôm…ô qeydi tapƒ±lmadƒ±"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"ƒ∞lk yenil…ôm…ôd…ôn sonra tarix burada g√∂r√ºn…ôc…ôk"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:["√úmumi ",N.length," qeyd"]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600",children:N.map((t,a)=>e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-white text-xs font-medium ${t.status==="success"?"bg-green-500":"bg-red-500"}`,children:t.status==="success"?"‚úì Uƒüurlu":"‚úó Uƒüursuz"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:["v",t.version_from||"?"," ‚Üí v",t.version_to||"?"]})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(t.created_at).toLocaleString("az-AZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),t.message&&e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:t.message}),t.release_notes&&e.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 p-2 rounded",children:["üìù ",t.release_notes.slice(0,100),"..."]})]},t.id))})]})]})]})]})})]})};export{oe as default};
