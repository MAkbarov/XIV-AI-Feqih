import{j as e,M as bt,r as ht,a as ft}from"./markdown-CGR2RDhP.js";import{a as m,L as H,b as B,H as kt}from"./vendor-4eYsLQor.js";import{I as u}from"./Icon-4HnnCzTR.js";import{a as he,u as Xe}from"./app-CzbWqHbf.js";import{F as vt}from"./Footer-BjTiE0I4.js";import{A as Y}from"./index-DHi4oDk3.js";import{m as p}from"./proxy-CfrAqMoI.js";import{r as wt}from"./index-Cn3or5DS.js";import"./app-C9FNok6L.js";const jt=({className:d=""})=>{const{isDarkMode:n}=he(),[s,v]=m.useState(null),[h,r]=m.useState(!0),[f,P]=m.useState(!1),[S,x]=m.useState(!1);m.useEffect(()=>{const k=localStorage.getItem("donation_dismissed_until"),C=Date.now();if(k&&C<parseInt(k)){x(!0),r(!1);return}b()},[]);const b=async()=>{try{const C=await(await fetch("/api/donation-settings")).json();C&&C.enabled&&(v(C),setTimeout(()=>{P(!0)},2e3))}catch(k){console.error("Error fetching donation settings:",k)}finally{r(!1)}},w=()=>{x(!0),P(!1)},j=()=>{const k=Date.now()+6048e5;localStorage.setItem("donation_dismissed_until",k.toString()),x(!0),P(!1)};return h||!s||S?null:e.jsx(Y,{children:f&&e.jsx(p.div,{className:"fixed inset-0 backdrop-blur-lg flex items-center justify-center z-50 p-4 modal-overlay",style:{background:n?"linear-gradient(135deg, rgba(31, 41, 55, 0.85) 0%, rgba(17, 24, 39, 0.9) 100%) !important":"linear-gradient(135deg, rgba(249, 250, 251, 0.85) 0%, rgba(255, 255, 255, 0.9) 100%) !important"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},onClick:()=>P(!1),children:e.jsxs(p.div,{className:`max-w-md w-full rounded-3xl shadow-2xl relative overflow-hidden border-2 backdrop-blur-md modal-content donation-modal ${n?"dark":""} ${n?"border-gray-600/50":"border-gray-200/50"}`,style:{background:s.background_color||(n?"linear-gradient(135deg, rgba(31, 41, 55, 0.95) 0%, rgba(17, 24, 39, 0.98) 100%) !important":"linear-gradient(135deg, rgba(249, 250, 251, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%) !important"),color:s.text_color||(n?"#ffffff !important":"#333333 !important"),backdropFilter:"blur(20px)",boxShadow:n?"0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05)":"0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.1)"},initial:{scale:.8,opacity:0,y:50,rotateX:15},animate:{scale:1,opacity:1,y:0,rotateX:0},exit:{scale:.8,opacity:0,y:50,rotateX:15},transition:{type:"spring",damping:25,stiffness:300,duration:.5},whileHover:{scale:1.02,y:-5},onClick:k=>k.stopPropagation(),children:[e.jsx(p.button,{onClick:w,className:`absolute top-5 right-5 w-10 h-10 flex items-center justify-center rounded-full transition-all duration-300 z-10 text-xl font-medium ${n?"bg-gray-700/70 hover:bg-gray-600/80 text-gray-300 hover:text-white border border-gray-600/50":"bg-gray-100/70 hover:bg-gray-200/80 text-gray-600 hover:text-gray-800 border border-gray-200/50"}`,whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},children:"√ó"}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(p.h3,{className:"text-2xl font-bold mb-6 pr-10 leading-tight",style:{color:s.text_color||(n?"#ffffff":"#333333")},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:s.title}),e.jsx(p.div,{className:`text-base leading-relaxed prose max-w-none ${n?"dark:prose-invert":""}`,style:{color:s.text_color||(n?"#ffffff":"#333333"),"--tw-prose-body":s.text_color||(n?"#ffffff":"#333333"),"--tw-prose-headings":s.text_color||(n?"#ffffff":"#333333"),"--tw-prose-bold":s.text_color||(n?"#ffffff":"#333333"),"--tw-prose-links":s.text_color||(n?"#ffffff":"#333333")},dangerouslySetInnerHTML:{__html:s.content},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2}})]}),e.jsxs(p.div,{className:"space-y-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(p.div,{className:"flex-1",children:e.jsx(H,{href:"/donation",className:"w-full block px-6 py-4 rounded-xl font-bold text-white text-center transition-all duration-300 shadow-lg",style:{backgroundColor:s.button_color||"#3b82f6"},onMouseEnter:k=>{k.target.style.filter="brightness(110%)",k.target.style.transform="translateY(-2px)",k.target.style.boxShadow="0 20px 40px rgba(0,0,0,0.2)"},onMouseLeave:k=>{k.target.style.filter="brightness(100%)",k.target.style.transform="translateY(0px)",k.target.style.boxShadow="0 10px 25px rgba(0,0,0,0.1)"},children:"üíù D…ôst…ôk Ol"})}),e.jsx(p.button,{className:`px-6 py-4 rounded-xl font-medium transition-all duration-300 hover:shadow-md backdrop-blur-sm ${n?"text-gray-300 border border-gray-600/60 hover:bg-gray-700/60 hover:border-gray-500":"text-gray-600 border border-gray-300/60 hover:bg-gray-50/60 hover:border-gray-400"}`,onClick:w,whileHover:{scale:1.05},whileTap:{scale:.95},children:"Baƒüla"})]}),e.jsx(p.button,{className:`w-full text-sm underline transition-colors py-2 rounded-lg ${n?"text-gray-400 hover:text-gray-200 hover:bg-gray-700/30":"text-gray-500 hover:text-gray-700 hover:bg-gray-100/30"}`,onClick:j,whileHover:{scale:1.02},children:"1 h…ôft…ô g√∂st…ôrm…ô"})]})]})]})})})},Nt=({isOpen:d,onAccept:n,onReject:s,siteName:v="XIV AI"})=>{const{theme:h}=he(),[r,f]=m.useState(!1),[P,S]=m.useState(null),[x,b]=m.useState(!0),w=async()=>{try{const k=await(await fetch("/api/guest-terms")).json();S(k)}catch{console.warn("Failed to fetch admin terms, using fallback"),S({title:"ƒ∞stifad…ô ≈û…ôrtl…ôri",content:"<p>ƒ∞stifad…ô ≈ü…ôrtl…ôri y√ºkl…ônm…ôdi.</p>"})}finally{b(!1)}};return m.useEffect(()=>{d&&!P&&w()},[d]),m.useEffect(()=>(d?(f(!0),document.body.style.overflow="hidden"):document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[d]),d?e.jsx(Y,{children:r&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 bg-black/70 backdrop-blur-md",onClick:()=>s&&s()}),e.jsxs(p.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,type:"spring",stiffness:300,damping:25},className:"relative z-50 bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full mx-4 max-h-[90vh] overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 text-white",style:{background:h?.primary_color?`linear-gradient(135deg, ${h.primary_color} 0%, ${h.secondary_color||h.primary_color} 100%)`:"linear-gradient(135deg, #10b981 0%, #065f46 100%)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(u,{name:"shield_check",size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:x?"ƒ∞stifad…ô ≈û…ôrtl…ôri":P?.title||"ƒ∞stifad…ô ≈û…ôrtl…ôri"}),e.jsx("p",{className:"text-blue-100 text-sm",children:v})]})]})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-96",children:x?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Y√ºkl…ônir..."})]}):e.jsx("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:P?.content||"<p>ƒ∞stifad…ô ≈ü…ôrtl…ôri y√ºkl…ônm…ôdi.</p>"}})})}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-600 flex gap-3",style:{background:h?.primary_color?`linear-gradient(135deg, ${h.primary_color}15 0%, ${h.secondary_color||h.primary_color}15 100%)`:"linear-gradient(135deg, #10b98115 0%, #065f4615 100%)"},children:[e.jsxs("button",{onClick:s,className:"flex-1 px-4 py-3 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors flex items-center justify-center gap-2",children:[e.jsx(u,{name:"close",size:16}),e.jsx("span",{children:"R…ôdd et"})]}),e.jsxs("button",{onClick:n,className:"flex-1 px-4 py-3 text-white rounded-lg font-medium transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl",style:{background:h?.primary_color?`linear-gradient(135deg, ${h.primary_color} 0%, ${h.secondary_color||h.primary_color} 100%)`:"linear-gradient(135deg, #10b981 0%, #065f46 100%)",filter:"brightness(1)",":hover":{filter:"brightness(1.1)"}},onMouseEnter:j=>j.target.style.filter="brightness(1.1)",onMouseLeave:j=>j.target.style.filter="brightness(1)",children:[e.jsx(u,{name:"shield_check",size:16}),e.jsx("span",{children:"Q…ôbul edir…ôm"})]})]})]})]})}):null},St=({isOpen:d,onConfirm:n,onCancel:s,chatTitle:v="",siteName:h=""})=>{const{theme:r}=he();return d?e.jsx(Y,{children:e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 bg-black/70 backdrop-blur-md",onClick:s}),e.jsxs(p.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,type:"spring",stiffness:300,damping:25},className:"relative z-50 bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 text-white",style:{background:r?.primary_color?`linear-gradient(135deg, ${r.primary_color} 0%, ${r.secondary_color||r.primary_color} 100%)`:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(u,{name:"warning",size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"S√∂hb…ôti Sil"}),e.jsx("p",{className:"text-blue-100 text-sm",children:h})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-gray-700 dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e.jsx(u,{name:"warning",size:24,color:"#ef4444"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-gray-900 dark:text-gray-100",children:"Bu s√∂hb…ôti silm…ôk ist…ôdiyinizd…ôn …ôminsiz?"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Bu …ôm…ôl geri alƒ±na bilm…ôz."})]})]}),v&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Silin…ôc…ôk s√∂hb…ôt:"}),e.jsxs("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:['"',v,'"']})]})]})}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-600 flex gap-3",style:{background:r?.primary_color?`linear-gradient(135deg, ${r.primary_color}10 0%, ${r.secondary_color||r.primary_color}10 100%)`:"linear-gradient(135deg, #ef444415 0%, #dc262615 100%)"},children:[e.jsxs("button",{onClick:s,className:"flex-1 px-4 py-3 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors flex items-center justify-center gap-2",children:[e.jsx(u,{name:"close",size:16}),e.jsx("span",{children:"L…ôƒüv et"})]}),e.jsxs("button",{onClick:n,className:"flex-1 px-4 py-3 text-white rounded-lg font-medium transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl bg-red-500 hover:bg-red-600",children:[e.jsx(u,{name:"delete",size:16}),e.jsx("span",{children:"Sil"})]})]})]})]})}):null},_t=({className:d="",chatbotName:n="AI Assistant"})=>e.jsxs("div",{className:`flex items-center space-x-1 ${d}`,children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 mr-2",children:n}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]}),Pt=({isOpen:d,onClose:n,isAuthenticated:s=!1})=>{const[v,h]=m.useState("color"),[r,f]=m.useState({type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null}),[P,S]=m.useState(!1),x=Xe(),b=(a,o)=>{const g=document.querySelector("#chat-container, [data-chat-background]");g&&o&&(console.log("Applying color preview:",{type:a,value:o}),g.style.setProperty("background-image","","important"),g.style.setProperty("background-size","","important"),g.style.setProperty("background-position","","important"),g.style.setProperty("background-repeat","","important"),g.style.setProperty("background-color","","important"),g.style.setProperty("background","","important"),g.style.setProperty("background-attachment","","important"),g.style.setProperty("background-origin","","important"),g.style.setProperty("background-clip","","important"),setTimeout(()=>{a==="solid"?(g.style.setProperty("background-color",o,"important"),g.style.setProperty("background-image","none","important"),g.style.setProperty("background","none","important"),g.style.setProperty("background-size","auto","important"),g.style.setProperty("background-position","0% 0%","important"),g.style.setProperty("background-repeat","repeat","important"),g.style.setProperty("background-attachment","scroll","important"),g.style.setProperty("background-origin","padding-box","important"),g.style.setProperty("background-clip","border-box","important"),console.log("Applied solid color preview:",o),setTimeout(()=>{console.log("Solid color verification:",{backgroundColor:g.style.backgroundColor,background:g.style.background,backgroundImage:g.style.backgroundImage,computedStyles:window.getComputedStyle(g).background})},100)):a==="gradient"&&(g.style.setProperty("background",o,"important"),g.style.setProperty("background-color","","important"),console.log("Applied gradient preview:",o)),window.dispatchEvent(new CustomEvent("backgroundChanged",{detail:{type:a,background:o}}))},10))};m.useEffect(()=>{d&&w()},[d,s]),m.useEffect(()=>{r&&r.type&&s&&(console.log("Settings changed, applying background:",r.type),z())},[r.type,r.color,r.gradient,r.image,s]),m.useEffect(()=>{d&&r&&r.type&&(console.log("Modal opened, applying preview for type:",r.type),r.type==="solid"?b("solid",r.color||"#f3f4f6"):r.type==="gradient"?b("gradient",r.gradient||"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"):r.type==="image"&&r.image&&$(r))},[d,r.type,r.color,r.gradient,r.image]);const w=async()=>{console.log("loadCurrentSettings called, isAuthenticated:",s);try{let a=null;if(s){console.log("Loading settings from API...");const o=await B.get("/api/user/background-settings");console.log("API response:",o.data),o.data.success?(a=o.data.settings,console.log("Loaded settings from API:",a),f(a)):(console.warn("API returned success=false"),a={type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null,imageSize:"cover",imagePosition:"center"},f(a))}else{console.log("Loading settings from cookies...");const o=j("guest_background_settings");if(console.log("Cookie settings:",o),o)try{a=JSON.parse(o),console.log("Parsed cookie settings:",a),f(a)}catch(g){console.warn("Failed to parse guest background settings:",g),a={type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null},f(a)}else a={type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null},f(a)}console.log("Setting active tab based on settings type:",a?.type),a&&a.type==="image"?(console.log("Setting active tab to image because type is image"),h("image")):(console.log("Setting active tab to color because type is solid/gradient:",a?.type),h("color"))}catch(a){console.error("Error loading background settings:",a),f({type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null}),h("color")}},j=a=>{const g=`; ${document.cookie}`.split(`; ${a}=`);return g.length===2?g.pop().split(";").shift():null},k=(a,o,g)=>{const T=new Date;T.setTime(T.getTime()+g*24*60*60*1e3),document.cookie=`${a}=${o};expires=${T.toUTCString()};path=/`},C=async()=>{console.log("handleSave called with settings:",r),S(!0);try{if(s){const a={type:r.type,color:r.type==="solid"?r.color:null,gradient:r.type==="gradient"?r.gradient:null,image:r.type==="image"?r.image:null,imageSize:r.type==="image"?r.imageSize:null,imagePosition:r.type==="image"?r.imagePosition:null};console.log("Sending save data:",a),console.log("Current settings:",r);const o=await B.post("/api/user/background-settings",a);console.log("Save response:",o.data),console.log("Current settings after save:",r),o.data.success?(x.success("Arxa fon parametrl…ôri saxlanƒ±ldƒ±!"),z(),n()):(console.log("Save failed:",o.data),x.error("X…ôta ba≈ü verdi!"))}else k("guest_background_settings",JSON.stringify(r),70),x.success("Arxa fon parametrl…ôri saxlanƒ±ldƒ±!"),z(),n()}catch(a){console.error("Save error:",a),x.error("Saxlama zamanƒ± x…ôta ba≈ü verdi!")}finally{S(!1)}},z=()=>{console.log("applyBackground called with settings:",r);const a=document.querySelector("#chat-container, [data-chat-background]");if(console.log("Chat container found:",a),a){let o="";switch(r.type){case"solid":o=r.color||"#f3f4f6",console.log("Solid color background style:",o);break;case"gradient":o=r.gradient,console.log("Gradient background style:",o);break;case"image":if(r.image){let g=r.image;!g.startsWith("http")&&!g.startsWith("/")&&(g="/"+g),o=`url(${g})`,a.style.backgroundSize=r.imageSize||"cover",a.style.backgroundPosition=r.imagePosition||"center",a.style.backgroundRepeat="no-repeat",console.log("Applied image background:",{url:g,size:r.imageSize||"cover",position:r.imagePosition||"center"})}else o=r.color||"#f3f4f6";break;default:o="#f3f4f6"}console.log("Applying background style:",o),r.type==="image"?(a.style.setProperty("background-image",o,"important"),a.style.setProperty("background-size",r.imageSize||"cover","important"),a.style.setProperty("background-position",r.imagePosition||"center","important"),a.style.setProperty("background-repeat","no-repeat","important"),a.style.setProperty("background-color","","important")):(a.style.setProperty("background-image","","important"),a.style.setProperty("background-size","","important"),a.style.setProperty("background-position","","important"),a.style.setProperty("background-repeat","","important"),r.type==="gradient"?(a.style.setProperty("background",o,"important"),a.style.setProperty("background-color","","important")):r.type==="solid"?(a.style.setProperty("background","none","important"),a.style.setProperty("background-image","none","important"),a.style.setProperty("background-size","auto","important"),a.style.setProperty("background-position","0% 0%","important"),a.style.setProperty("background-repeat","repeat","important"),a.style.setProperty("background-attachment","scroll","important"),a.style.setProperty("background-origin","padding-box","important"),a.style.setProperty("background-clip","border-box","important"),a.style.setProperty("background-color",o,"important"),console.log("Applied solid color with full reset:",o)):(a.style.setProperty("background-color",o,"important"),a.style.setProperty("background","","important"))),window.dispatchEvent(new CustomEvent("backgroundChanged",{detail:{type:r.type,background:o,imageSize:r.imageSize,imagePosition:r.imagePosition}}))}else console.error("Chat container not found! Available elements:"),console.log("Elements with id chat-container:",document.querySelectorAll("#chat-container")),console.log("Elements with data-chat-background:",document.querySelectorAll("[data-chat-background]")),console.log("All divs on page:",document.querySelectorAll("div").length),console.log("Page body classes:",document.body.className)},$=a=>{const o=document.querySelector("#chat-container, [data-chat-background]");if(o&&a.image){let g=a.image;!g.startsWith("http")&&!g.startsWith("/")&&(g="/"+g),o.style.setProperty("background","","important"),o.style.setProperty("background-color","","important"),o.style.setProperty("background-image",`url(${g})`,"important"),o.style.setProperty("background-size",a.imageSize||"cover","important"),o.style.setProperty("background-position",a.imagePosition||"center","important"),o.style.setProperty("background-repeat","no-repeat","important"),console.log("Applied persistent preview:",{url:g,size:a.imageSize||"cover",position:a.imagePosition||"center"})}},L=async()=>{if(console.log("Delete image called, current settings:",r),!r.image){console.log("No image to delete");return}S(!0);try{console.log("Sending delete request to /api/user/background-image");const a=await B.delete("/api/user/background-image",{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(console.log("Delete response:",a.data),a.data.success){f(g=>({...g,image:null,imageSize:"cover",imagePosition:"center",type:"solid",color:"#f3f4f6"})),h("color");const o=document.querySelector("#chat-container, [data-chat-background]");o&&(o.style.setProperty("background","none","important"),o.style.setProperty("background-image","none","important"),o.style.setProperty("background-size","auto","important"),o.style.setProperty("background-position","0% 0%","important"),o.style.setProperty("background-repeat","repeat","important"),o.style.setProperty("background-attachment","scroll","important"),o.style.setProperty("background-origin","padding-box","important"),o.style.setProperty("background-clip","border-box","important"),o.style.setProperty("background-color","#f3f4f6","important")),x.success("≈û…ôkil silindi!")}else x.error("≈û…ôkil silin…ôrk…ôn x…ôta ba≈ü verdi!")}catch(a){console.error("Delete error:",a),x.error("≈û…ôkil silin…ôrk…ôn x…ôta ba≈ü verdi!")}finally{S(!1)}},D=async a=>{if(!a)return;if(a.size>400*1024){x.error("≈û…ôkil √∂l√ß√ºs√º 400KB-dan b√∂y√ºk ola bilm…ôz!");return}S(!0);const o=new FormData;o.append("image",a);try{const g=await B.post("/api/user/upload-background-image",o,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(g.data.success){console.log("Upload successful, URL:",g.data.url);const T={...r,image:g.data.url,imageSize:"cover",imagePosition:"center",type:"image"};f(T),$(T),x.success("≈û…ôkil y√ºkl…ôndi!")}else console.log("Upload failed:",g.data),x.error("≈û…ôkil y√ºkl…ônm…ôdi!")}catch(g){console.error("Upload error:",g),console.error("Upload error response:",g.response),g.response&&console.error("Upload error data:",g.response.data),x.error("≈û…ôkil y√ºkl…ônm…ô x…ôtasƒ±!")}finally{S(!1)}},A=[{name:"G√∂y-B…ôn√∂v≈ü…ôyi",value:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},{name:"√á…ôhrayƒ±-Narƒ±ncƒ±",value:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"},{name:"Ya≈üƒ±l-Mavi",value:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"},{name:"Qƒ±zƒ±l-Narƒ±ncƒ±",value:"linear-gradient(135deg, #ffa751 0%, #ff6b6b 100%)"},{name:"B…ôn√∂v≈ü…ôyi-√á…ôhrayƒ±",value:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"},{name:"T√ºnd Mavi",value:"linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)"}];return d?e.jsx(Y,{children:e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(p.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Arxa Fon Parametrl…ôri"}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(u,{name:"close",size:20})})]}),e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>{h("color"),r.type==="image"&&f(a=>({...a,type:"solid"}))},className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${v==="color"?"text-purple-600 border-b-2 border-purple-600 bg-purple-50 dark:bg-purple-900/20":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:"R…ông & Gradient"}),e.jsxs("button",{onClick:()=>{h("image"),r.image&&(f(a=>({...a,type:"image"})),$(r))},disabled:!s,className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${v==="image"&&s?"text-purple-600 border-b-2 border-purple-600 bg-purple-50 dark:bg-purple-900/20":s?"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200":"text-gray-300 dark:text-gray-600 cursor-not-allowed"}`,children:["≈û…ôkil ",!s&&"üîí"]})]}),e.jsxs("div",{className:"p-6",children:[v==="color"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{console.log("Solid color selected");const a={...r,type:"solid"};f(a),b("solid",r.color||"#f3f4f6")},className:`flex-1 p-3 rounded-lg border-2 text-sm font-medium transition-all ${r.type==="solid"?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:"Solid R…ông"}),e.jsx("button",{onClick:()=>{console.log("Gradient selected");const a={...r,type:"gradient"};f(a),b("gradient",r.gradient||"linear-gradient(135deg, #667eea 0%, #764ba2 100%)")},className:`flex-1 p-3 rounded-lg border-2 text-sm font-medium transition-all ${r.type==="gradient"?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:"Gradient"})]}),r.type==="solid"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"R…ông se√ßin"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"color",value:r.color,onChange:a=>{console.log("Color changed to:",a.target.value);const o={...r,color:a.target.value,type:"solid"};f(o),b("solid",a.target.value)},className:"w-16 h-12 rounded-lg border-2 border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:r.color,onChange:a=>{console.log("Color text changed to:",a.target.value);const o={...r,color:a.target.value,type:"solid"};f(o),b("solid",a.target.value)},className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"#f3f4f6"})]})]}),r.type==="gradient"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"X√ºsusi Gradient CSS"}),e.jsx("textarea",{value:r.gradient,onChange:a=>{console.log("Gradient changed to:",a.target.value);const o={...r,gradient:a.target.value,type:"gradient"};f(o),b("gradient",a.target.value)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-mono text-sm h-20",placeholder:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hazƒ±r Gradientl…ôr"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:A.map((a,o)=>e.jsx("button",{onClick:()=>{const g={...r,gradient:a.value,type:"gradient"};f(g),b("gradient",a.value)},className:"text-xs px-3 py-2 border rounded-lg text-left hover:opacity-80 transition-opacity text-white font-medium",style:{background:a.value},children:a.name},o))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"√ñnizl…ôm…ô"}),e.jsx("div",{className:"w-full h-20 rounded-lg border-2 border-gray-200 flex items-center justify-center",style:{background:r.type==="solid"?r.color:r.gradient},children:e.jsx("span",{className:"bg-black/20 px-3 py-1 rounded text-white text-sm font-medium",children:"Arxa Fon N√ºmun…ôsi"})})]})]}),v==="image"&&e.jsx("div",{className:"space-y-4",children:s?e.jsxs(e.Fragment,{children:[r.image?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center bg-gray-50 dark:bg-gray-800",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üö´"}),e.jsx("span",{className:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"≈û…ôkil y√ºkl…ônib"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-500",children:"Ba≈üqa ≈ü…ôkil y√ºkl…ôm…ôk √º√ß√ºn m√∂vcud ≈ü…ôkili silin"})]}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üì∑"}),e.jsxs("label",{htmlFor:"background-image-upload",className:"cursor-pointer",children:[e.jsx("span",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:"≈û…ôkil y√ºkl…ôyin"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF (Maksimum 400KB)"}),e.jsx("input",{id:"background-image-upload",type:"file",accept:"image/*",className:"sr-only",onChange:a=>D(a.target.files[0])})]})]}),r.image&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Cari ≈û…ôkil"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-full h-40 rounded-lg border-2 border-gray-200 overflow-hidden",style:{backgroundImage:`url(${r.image})`,backgroundSize:r.imageSize||"cover",backgroundPosition:r.imagePosition||"center",backgroundRepeat:"no-repeat"},children:e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black/10",children:e.jsx("span",{className:"bg-white/90 px-2 py-1 rounded text-xs font-medium text-gray-700",children:"√ñnizl…ôm…ô"})})}),e.jsx("button",{onClick:L,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-7 h-7 flex items-center justify-center text-sm hover:bg-red-600 transition-colors",title:"≈û…ôkili sil",children:"√ó"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"≈û…ôkil √ñl√ß√ºs√º"}),e.jsx("div",{className:"flex gap-2",children:["cover","contain","auto","100% 100%"].map(a=>e.jsx("button",{onClick:()=>{const o={...r,imageSize:a};f(o),$(o)},className:`px-3 py-1 text-xs rounded-lg border transition-colors ${(r.imageSize||"cover")===a?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-gray-200 dark:border-gray-600 hover:border-gray-300 text-gray-700 dark:text-gray-300"}`,children:a==="cover"?"Doldur":a==="contain"?"Sƒ±ƒüƒ±≈üdƒ±r":a==="auto"?"Orjinal":"Uzat"},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"≈û…ôkil M√∂vqeyi"}),e.jsx("div",{className:"grid grid-cols-3 gap-1 max-w-[120px]",children:[["top left","‚ÜñÔ∏è"],["top center","‚¨ÜÔ∏è"],["top right","‚ÜóÔ∏è"],["center left","‚¨ÖÔ∏è"],["center","‚≠ï"],["center right","‚û°Ô∏è"],["bottom left","‚ÜôÔ∏è"],["bottom center","‚¨áÔ∏è"],["bottom right","‚ÜòÔ∏è"]].map(([a,o])=>e.jsx("button",{onClick:()=>{const g={...r,imagePosition:a};f(g),$(g)},className:`w-8 h-8 text-xs rounded border flex items-center justify-center transition-colors ${(r.imagePosition||"center")===a?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-600":"border-gray-200 dark:border-gray-600 hover:border-gray-300 text-gray-500"}`,title:a,children:o},a))})]})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"D…ôyi≈üiklikl…ôr real-time g√∂st…ôrilir"})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üîí"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"≈û…ôkil Y√ºkl…ôm…ô Qadaƒüandƒ±r"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"≈û…ôkil y√ºkl…ôm…ôk √º√ß√ºn hesaba daxil olmalƒ±sƒ±nƒ±z"})]})})]}),e.jsxs("div",{className:"flex gap-2 p-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:n,className:"flex-1 px-4 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"L…ôƒüv et"}),e.jsx("button",{onClick:async()=>{f({type:"default",color:"transparent",gradient:"",image:null,imageSize:"cover",imagePosition:"center"});const o=document.querySelector("#chat-container, [data-chat-background]");o&&(o.style.setProperty("background","","important"),o.style.setProperty("background-image","","important"),o.style.setProperty("background-size","","important"),o.style.setProperty("background-position","","important"),o.style.setProperty("background-repeat","","important"),o.style.setProperty("background-color","","important"),o.style.setProperty("background-attachment","","important"),o.style.setProperty("background-origin","","important"),o.style.setProperty("background-clip","","important"));try{if(S(!0),console.log("Sending reset request with current settings:",r),s){const g={type:"default",color:null,gradient:null,image:null,imageSize:null,imagePosition:null};console.log("Sending reset data to API:",g);const T=await B.post("/api/user/background-settings",g);console.log("Reset API response:",T.data),T.data.success?(console.log("Reset successful - background and file should be deleted"),x.success("Arxa fon v…ô ≈ü…ôkil sƒ±fƒ±rlandƒ±!")):(console.error("Reset failed:",T.data),x.error("Sƒ±fƒ±rlama uƒüursuz oldu!"))}else document.cookie="guest_background_settings=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",x.success("Qonaq parametrl…ôri sƒ±fƒ±rlandƒ±!");setTimeout(()=>{w()},500),n()}catch(g){console.error("Reset error details:",g),console.error("Error response:",g.response?.data),x.error("Sƒ±fƒ±rlama zamanƒ± x…ôta ba≈ü verdi: "+(g.response?.data?.message||g.message))}finally{S(!1)}},disabled:P,className:"px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 transition-colors text-sm",title:"Defolt r…ông…ô qaytar",children:"Sƒ±fƒ±rlamaq"}),e.jsx("button",{onClick:C,disabled:P,className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-lg hover:from-purple-600 hover:to-indigo-700 disabled:opacity-50 transition-colors",children:P?"Saxlanƒ±r...":"Yadda Saxla"})]})]})})}):null},Ct=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,zt=({isAuthenticated:d=!1})=>{const[n,s]=m.useState(!1),[v,h]=m.useState(!1),[r,f]=m.useState({x:0,y:0}),P=m.useRef(null),S=m.useRef(null),x=64,b=Ct(),w=b?{dragTransition:{bounceStiffness:300,bounceDamping:30},springConfig:{type:"spring",stiffness:200,damping:25},hoverScale:1.05,tapScale:.95,dragScale:1.02}:{dragTransition:{bounceStiffness:600,bounceDamping:20},springConfig:{type:"spring",stiffness:260,damping:20},hoverScale:1.1,tapScale:.9,dragScale:1.05};m.useEffect(()=>{const L=()=>{const D=window.innerWidth,A=window.innerHeight,a=20;f({x:Math.min(D-x-a,D-100),y:Math.min(A/2-x/2,A-x-a)})};return L(),window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]);const j=(L,D)=>{const A=window.innerWidth,a=window.innerHeight,o=10;return{x:Math.max(o,Math.min(L,A-x-o)),y:Math.max(o,Math.min(D,a-x-o))}},k=()=>{S.current=Date.now(),h(!0)},C=(L,D)=>{const A=j(D.point.x-x/2,D.point.y-x/2);f(A)},z=()=>{const L=Date.now()-S.current;setTimeout(()=>{h(L>150)},50)},$=()=>{v||s(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(p.div,{ref:P,drag:!b||"true",dragMomentum:!1,dragTransition:w.dragTransition,dragElastic:b?.05:.1,onDragStart:k,onDrag:C,onDragEnd:z,onClick:$,className:"fixed z-50 cursor-pointer select-none",style:{left:r.x,top:r.y,willChange:"transform",transform:"translateZ(0)"},initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:w.springConfig,whileHover:{scale:w.hoverScale},whileTap:{scale:w.tapScale},whileDrag:{scale:w.dragScale,cursor:"grabbing"},children:[e.jsx("div",{className:`w-16 h-16 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-full shadow-lg flex items-center justify-center backdrop-blur border border-white/20 ${b?"transition-none":"hover:shadow-xl transition-all duration-300"}`,style:{willChange:"transform, box-shadow",transform:"translateZ(0)"},children:e.jsx(u,{name:"settings",size:24,color:"#ffffff"})}),!b&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-purple-500 to-indigo-600 animate-ping opacity-20"})]}),e.jsx(Pt,{isOpen:n,onClose:()=>s(!1),isAuthenticated:d})]})},Dt=d=>{const s=`; ${document.cookie}`.split(`; ${d}=`);return s.length===2?s.pop().split(";").shift():null},Ue=d=>{console.log("BackgroundLoader: applyBackgroundFromSettings called",d);const n=document.querySelector("#chat-container, [data-chat-background]");if(console.log("BackgroundLoader: Chat container found:",n),!n){console.error("BackgroundLoader: Chat container not found!");return}let s="";switch(d.type){case"solid":s=d.color;break;case"gradient":s=d.gradient;break;case"image":if(d.image){let v=d.image;!v.startsWith("http")&&!v.startsWith("/")&&(v="/"+v),s=`url(${v})`,n.style.backgroundSize=d.imageSize||"cover",n.style.backgroundPosition=d.imagePosition||"center",n.style.backgroundRepeat="no-repeat",console.log("BackgroundLoader: Applied image background:",{url:v,size:d.imageSize||"cover",position:d.imagePosition||"center"})}else s=d.color||"#f3f4f6";break;default:s="#f3f4f6"}console.log("BackgroundLoader: Applying background style:",s),d.type==="image"?(n.style.backgroundImage=s,n.style.backgroundSize=d.imageSize||"cover",n.style.backgroundPosition=d.imagePosition||"center",n.style.backgroundRepeat="no-repeat",n.style.backgroundColor=""):(n.style.backgroundImage="",n.style.backgroundSize="",n.style.backgroundPosition="",n.style.backgroundRepeat="",d.type==="gradient"?(n.style.background=s,n.style.backgroundColor=""):d.type==="solid"?(n.style.setProperty("background","none","important"),n.style.setProperty("background-image","none","important"),n.style.setProperty("background-size","auto","important"),n.style.setProperty("background-position","0% 0%","important"),n.style.setProperty("background-repeat","repeat","important"),n.style.setProperty("background-attachment","scroll","important"),n.style.setProperty("background-origin","padding-box","important"),n.style.setProperty("background-clip","border-box","important"),n.style.setProperty("background-color",s,"important"),console.log("BackgroundLoader: Applied solid color with full reset:",s)):(n.style.backgroundColor=s,n.style.background=""))},Ie=async(d=!1)=>{console.log("BackgroundLoader: loadUserBackground called, isAuthenticated:",d);try{if(d){console.log("BackgroundLoader: Loading from API for authenticated user");const n=await fetch("/api/user/background-settings",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(console.log("BackgroundLoader: API response status:",n.status),n.ok){const s=await n.json();console.log("BackgroundLoader: API response data:",s),s.success?Ue(s.settings):console.warn("BackgroundLoader: API returned success=false")}else console.error("BackgroundLoader: API request failed with status:",n.status)}else{const n=Dt("guest_background_settings");if(n)try{const s=JSON.parse(n);Ue(s)}catch(s){console.warn("Failed to parse guest background settings:",s)}}}catch(n){console.warn("Failed to load user background:",n)}},Tt=({text:d,speed:n=50,onComplete:s})=>{const[v,h]=m.useState(""),[r,f]=m.useState(0);return m.useEffect(()=>{h(""),f(0)},[d]),m.useEffect(()=>{if(r<d.length){const P=setTimeout(()=>{h(S=>S+d[r]),f(S=>S+1)},n);return()=>clearTimeout(P)}else r===d.length&&r>0&&s&&s()},[r,d,n,s]),e.jsx("span",{children:v})},Mt=({content:d})=>e.jsx(bt,{remarkPlugins:[ft],rehypePlugins:[ht],components:{h1:({node:n,...s})=>e.jsx("h1",{className:"text-2xl font-bold mb-1 text-gray-800 dark:text-gray-100",...s}),h2:({node:n,...s})=>e.jsx("h2",{className:"text-xl font-semibold mb-1 text-gray-800 dark:text-gray-100",...s}),h3:({node:n,...s})=>e.jsx("h3",{className:"text-lg font-medium mb-1 text-gray-700 dark:text-gray-200",...s}),h4:({node:n,...s})=>e.jsx("h4",{className:"text-base font-medium mb-1 text-gray-700 dark:text-gray-200",...s}),p:({node:n,...s})=>e.jsx("p",{className:"mb-1 leading-normal text-gray-800 dark:text-gray-200",...s}),strong:({node:n,...s})=>e.jsx("strong",{className:"font-bold text-gray-900 dark:text-gray-100",...s}),em:({node:n,...s})=>e.jsx("em",{className:"italic text-gray-800 dark:text-gray-200",...s}),ul:({node:n,...s})=>e.jsx("ul",{className:"list-disc list-inside mb-1 space-y-0.5 text-gray-800 dark:text-gray-200",...s}),ol:({node:n,...s})=>e.jsx("ol",{className:"list-decimal list-inside mb-1 space-y-0.5 text-gray-800 dark:text-gray-200",...s}),li:({node:n,...s})=>e.jsx("li",{className:"text-gray-800 dark:text-gray-200",...s}),blockquote:({node:n,...s})=>e.jsx("blockquote",{className:"border-l-4 border-emerald-400 pl-4 py-1 mb-1 bg-emerald-50 dark:bg-emerald-900/30 text-gray-700 dark:text-gray-300",...s}),code:({node:n,inline:s,...v})=>s?e.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 py-0.5 rounded text-sm font-mono text-gray-800 dark:text-gray-200",...v}):e.jsx("code",{className:"block bg-gray-100 dark:bg-gray-700 p-3 rounded-lg text-sm font-mono text-gray-800 dark:text-gray-200 overflow-x-auto",...v}),a:({node:n,...s})=>e.jsx("a",{className:"text-emerald-600 dark:text-emerald-400 hover:text-emerald-700 dark:hover:text-emerald-300 underline",target:"_blank",rel:"noopener noreferrer",...s})},children:d});function Wt({auth:d,sessions:n=[],settings:s={},theme:v={},footerSettings:h={}}){const r=Xe(),{theme:f,isDarkMode:P,toggleDarkMode:S,refreshTheme:x}=he(),b=f||v,w={...b,isDarkMode:P,toggleDarkMode:S},[j,k]=m.useState(null),[C,z]=m.useState([]),[$,L]=m.useState(""),[D,A]=m.useState(!1),[a,o]=m.useState(!1),[g,T]=m.useState([]),[fe,ge]=m.useState(n||[]);m.useEffect(()=>{ge(n||[])},[JSON.stringify(n)]);const[Q,Je]=m.useState(!0),[Ke,ke]=m.useState(new Set),[E,V]=m.useState(!1),[I,G]=m.useState(!1);m.useEffect(()=>{console.log("Sidebar state:",I,"Window width:",window.innerWidth)},[I]);const[Le,ve]=m.useState(null),[X,Ye]=m.useState(new Map),[Ze,me]=m.useState(!1),we=m.useRef(null),[Ee,Qe]=m.useState({top:0,left:0,align:"left"}),$e=t=>{try{const c=t.getBoundingClientRect(),i=8,l=window.innerWidth,y=c.right+320<l,N=y?Math.max(8,c.left):Math.max(8,c.right-320),_=Math.min(window.innerHeight-200,c.bottom+i);Qe({top:_,left:N,align:y?"left":"right"})}catch{}},[Ae,Ve]=m.useState(()=>{try{const t=localStorage.getItem("feedbackGiven"),c=t?JSON.parse(t):[];return new Set(c.map(String))}catch{return new Set}}),et=t=>{try{const c=new Set(Ae);c.add(String(t)),Ve(c),localStorage.setItem("feedbackGiven",JSON.stringify([...c]))}catch{}},F=m.useRef(null),ee=m.useRef(null),[tt,je]=m.useState(!1),[rt,Ne]=m.useState(!1),[R,U]=m.useState(!0),[at,Se]=m.useState(!1),[W,_e]=m.useState(null),[O,ue]=m.useState(()=>{const t=Number(localStorage.getItem("messageFontScale"));return t&&t>=.85&&t<=1.4?t:1}),[st,ot]=m.useState(!1),[Pe,pe]=m.useState(new Map),[qe,nt]=m.useState(null);m.useEffect(()=>{try{localStorage.setItem("messageFontScale",String(O))}catch{}},[O]);const it=async()=>{if(W)try{if(d?.user){const t=document.querySelector('meta[name="csrf-token"]').getAttribute("content");try{await B.delete(`/chat/${W.session_id}`,{headers:{"X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"}})}catch{await B.post(`/chat/${W.session_id}/delete`,{},{headers:{"X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"}})}ge(c=>c.filter(i=>i.session_id!==W.session_id)),j===W.session_id&&(k(null),z([]))}else{const c=JSON.parse(localStorage.getItem("guestChatSessions")||"[]").filter(i=>i.session_id!==W.session_id);localStorage.setItem("guestChatSessions",JSON.stringify(c)),T(c),j===W.session_id&&(k(null),z([]))}r.success("S√∂hb…ôt silindi!")}catch(t){console.error("Delete session error:",t),r.error("S√∂hb…ôt silin…ôrk…ôn x…ôta ba≈ü verdi")}finally{Se(!1),_e(null)}},lt=()=>{Se(!1),_e(null)},[q,Ce]=m.useState({allowed:!0,remaining:0,daily_remaining:0,monthly_remaining:0,reset_time:null,monthly_reset_time:null,user_type:"guest"}),[te,ze]=m.useState(!1),[re,De]=m.useState(null),Be=s.chatbot_name||"AI Assistant",ye=s.site_name||"XIV AI Chatbot Platform",dt=s.chat_disclaimer_text||"√áatbotun cavablarƒ±nƒ± yoxlayƒ±n, s…ôhv ed…ô bil…ôr!",J=Number(s.message_input_limit||s.guest_input_limit||500),Fe=s.ai_response_type||"typewriter",ct=Number(s.ai_typing_speed||50),gt=Number(s.ai_thinking_time||1e3),xe=!d?.user,ae=$.length,mt=J-ae,K=J>0&&ae>J,M=b?.primary_color,se=b?.secondary_color;b?.accent_color,b?.background_gradient;const be=(()=>{const t=typeof window<"u"?window.innerWidth<768:!1,c=w.isDarkMode,i=s||{},l=i.brand_logo_desktop_light,y=i.brand_logo_desktop_dark,N=i.brand_logo_mobile_light,_=i.brand_logo_mobile_dark;if(t){if(c&&_)return _;if(!c&&N)return N}else{if(c&&y)return y;if(!c&&l)return l}return i.brand_logo_url||""})(),Te=(()=>{const t=b?.chat_background_type;if(!t||t==="default"||t===null)return"transparent";switch(t){case"solid":return b?.chat_background_color||"transparent";case"gradient":return b?.chat_background_gradient||"transparent";case"image":return b?.chat_background_image?`url(${b.chat_background_image})`:"transparent";default:return"transparent"}})(),He=t=>{if(!t)return"";const i=t-new Date;if(i<=0)return"Yenil…ônir...";const l=Math.floor(i/(1e3*60*60)),y=Math.floor(i%(1e3*60*60)/(1e3*60)),N=Math.floor(i%(1e3*60)/1e3);return l>0?`${l} saat ${y} d…ôqiq…ô ${N} saniy…ô`:y>0?`${y} d…ôqiq…ô ${N} saniy…ô`:`${N} saniy…ô`},oe=async()=>{try{const c=await(await fetch(`/api/chat-limits?t=${Date.now()}`,{cache:"no-store"})).json();Ce(c),c.allowed?(ze(!1),(rt||d?.user)&&U(!1)):(ze(!0),U(!0),c.reset_time&&De(new Date(c.reset_time)))}catch(t){console.error("Failed to fetch limits:",t)}};m.useEffect(()=>{if(d?.user)U(!1),Ne(!0);else{const t=JSON.parse(localStorage.getItem("guestChatSessions")||"[]");T(t),localStorage.getItem("guest-terms-accepted")==="true"?(Ne(!0),U(!1)):(je(!0),U(!0))}oe()},[d?.user]),m.useEffect(()=>{oe();const t=setInterval(oe,3e4),c=setInterval(()=>{re&&re-new Date<=0&&(oe(),De(null))},1e3);return()=>{clearInterval(t),clearInterval(c)}},[re]),m.useEffect(()=>{const t=()=>{x&&x(),oe()};return window.addEventListener("focus",t),()=>window.removeEventListener("focus",t)},[x]),m.useEffect(()=>{const t=setTimeout(()=>{Ie(!!d?.user),setTimeout(()=>{const i=document.querySelector("#chat-container, [data-chat-background]");i&&!i.style.backgroundImage&&!i.style.background&&(console.log("Chat background retry - first attempt may have failed"),Ie(!!d?.user))},1e3)},500),c=i=>{if(i.detail&&i.detail.background){const l=document.querySelector("#chat-container, [data-chat-background]");l&&(i.detail.type==="image"?(l.style.backgroundImage=i.detail.background,l.style.backgroundSize=i.detail.imageSize||"cover",l.style.backgroundPosition=i.detail.imagePosition||"center",l.style.backgroundRepeat="no-repeat",l.style.backgroundColor=""):(l.style.backgroundImage="",l.style.backgroundSize="",l.style.backgroundPosition="",l.style.backgroundRepeat="",i.detail.type==="gradient"?(l.style.background=i.detail.background,l.style.backgroundColor=""):i.detail.type==="solid"?(l.style.setProperty("background","none","important"),l.style.setProperty("background-image","none","important"),l.style.setProperty("background-size","auto","important"),l.style.setProperty("background-position","0% 0%","important"),l.style.setProperty("background-repeat","repeat","important"),l.style.setProperty("background-attachment","scroll","important"),l.style.setProperty("background-origin","padding-box","important"),l.style.setProperty("background-clip","border-box","important"),l.style.setProperty("background-color",i.detail.background,"important"),console.log("Chat listener applied solid color:",i.detail.background)):(l.style.backgroundColor=i.detail.background,l.style.background="")))}setTimeout(()=>Ie(!!d?.user),200)};return window.addEventListener("backgroundChanged",c),()=>{clearTimeout(t),window.removeEventListener("backgroundChanged",c)}},[d?.user]);const Re=(t,c,i)=>{if(!d?.user){const l={session_id:t,title:c||t.slice(0,8),messages:i||[],created_at:new Date().toISOString()},y=JSON.parse(localStorage.getItem("guestChatSessions")||"[]"),N=y.findIndex(Z=>Z.session_id===t);N>=0?y[N]={...y[N],messages:i}:y.unshift(l);const _=y.slice(0,10);localStorage.setItem("guestChatSessions",JSON.stringify(_)),T(_)}},ut=async t=>{if(d?.user)try{const{data:c}=await B.get(`/chat/${t}`);z(c.messages)}catch(c){r.error("S√∂hb…ôt y√ºkl…ônm…ôdi"),console.error("loadSession error:",c)}else{const c=g.find(i=>i.session_id===t);c&&z(c.messages||[])}k(t)},pt=()=>{localStorage.setItem("guest-terms-accepted","true"),Ne(!0),te||U(!1),je(!1),r.success("ƒ∞stifad…ô ≈ü…ôrtl…ôri q…ôbul edildi! ƒ∞ndi √ßatbotla danƒ±≈üa bil…ôrsiniz.")},yt=()=>{je(!1),U(!0),r.warning("ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul etm…ôd…ôn √ßatbotla danƒ±≈üa bilm…ôzsiniz.")},Ge=async()=>{if(!$.trim())return;if(E){r.warning("√áatbot h…ôl…ô d…ô yazƒ±r. Z…ôhm…ôt olmasa g√∂zl…ôyin.");return}if(R){r.warning("ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul etm…ôd…ôn mesaj g√∂nd…ôr…ô bilm…ôzsiniz.");return}if(K){r.warning(`Daxiletm…ô limiti: ${J}. Cari: ${ae} simvol`);return}const t={role:"user",content:$,created_at:new Date().toISOString()};z(i=>[...i,{...t,id:`local-${Date.now()}`}]),L("");try{ee.current&&(ee.current.style.height="")}catch{}A(!0),o(!0);const c=new AbortController;ve(c);try{const{data:i}=await B.post("/chat/send",{message:t.content,session_id:j},{signal:c.signal});if(!j){k(i.session_id);const _=t.content.slice(0,40),Z=new Date().toISOString();if(d?.user){ge(le=>[{session_id:i.session_id,title:"",created_at:Z},...le]);let ne=0;const ie=setInterval(()=>{ne++;const le=_.slice(0,ne);ge(de=>de.map(ce=>ce.session_id===i.session_id?{...ce,title:le}:ce)),ne>=_.length&&clearInterval(ie)},Math.max(20,Math.min(80,1e3/Math.max(5,_.length))))}else{const ne={session_id:i.session_id,title:"",created_at:Z,messages:[t]};T(de=>[ne,...de]);let ie=0;const le=setInterval(()=>{ie++;const de=_.slice(0,ie);T(ce=>ce.map(Me=>Me.session_id===i.session_id?{...Me,title:de}:Me)),ie>=_.length&&clearInterval(le)},Math.max(20,Math.min(80,1e3/Math.max(5,_.length))))}}const l=`ai-${Date.now()}`;let y;if(Fe==="instant"){y={role:"assistant",content:i.message,fullContent:i.message,id:l,created_at:new Date().toISOString(),isTyping:!1};const _=[...C,t,y];z(Z=>[...Z,y])}else y={role:"assistant",content:"",fullContent:i.message,id:l,created_at:new Date().toISOString(),isTyping:!0},z(_=>[..._,y]),V(!0),setTimeout(()=>{ke(_=>new Set([..._,l]))},gt);const N=[...C,t,y];if(!d?.user){const _=j||i.session_id;Re(_,t.content,N)}i.limit_info&&Ce({allowed:i.limit_info.remaining>0,remaining:i.limit_info.remaining,daily_remaining:i.limit_info.daily_remaining,monthly_remaining:i.limit_info.monthly_remaining,reset_time:i.limit_info.reset_time,monthly_reset_time:i.limit_info.monthly_reset_time,user_type:d?.user?"user":"guest"})}catch(i){if(i.name==="CanceledError")r.info("Mesaj g√∂nd…ôrm…ô dayandƒ±rƒ±ldƒ±");else if(i.response?.status===429){const l=i.response.data;r.error(l.error||"Mesaj limiti dolmu≈üdur!"),l.limit_exceeded&&(ze(!0),U(!0),l.reset_time&&De(new Date(l.reset_time)),Ce({allowed:!1,remaining:l.remaining||0,daily_remaining:l.daily_remaining||0,monthly_remaining:l.monthly_remaining||0,reset_time:l.reset_time,monthly_reset_time:l.monthly_reset_time,user_type:d?.user?"user":"guest"}))}else r.error(i.response?.data?.error||"X…ôta ba≈ü verdi");V(!1)}finally{A(!1),ve(null),setTimeout(()=>{o(!1),Fe==="instant"&&V(!1)},600),setTimeout(()=>F.current?.scrollTo({top:F.current.scrollHeight,behavior:"smooth"}),50)}},We=async()=>{Le&&(Le.abort(),ve(null));try{await B.post("/chat/stop")}catch{}A(!1),o(!1),V(!1),ke(new Set),r.info("Cavab yazmaq dayandƒ±rƒ±ldƒ±")},Oe=async(t,c,i)=>{et(t);try{Ye(y=>{const N=new Map(y);return N.set(t,i),N}),await B.post("/chat/feedback",{message_id:t,session_id:j,message_content:c,feedback_type:i});const l=i==="like"?"R…ôyiniz √º√ß√ºn t…ô≈ü…ôkk√ºr edirik, bu bizi sevindirir. :)":"R…ôyiniz √º√ß√ºn t…ô≈ü…ôkk√ºr edirik, biz √ßatbotu t…ôkmil…ô≈üdir…ôc…ôyik, z…ôif t…ôcr√ºb…ômiz √º√ß√ºn √ºzr ist…ôyirik.";r.success(l)}catch(l){console.error("Feedback error:",l);const y=l?.response?.data?.error||"B…ôy…ôn/B…ôy…ônm…ô g√∂nd…ôrilm…ôdi";r.error(y)}},xt=t=>{t.key==="Enter"&&Q&&!t.shiftKey&&(t.preventDefault(),D||E?We():!R&&!E&&Ge())};return m.useEffect(()=>{F.current&&(F.current.scrollTop=F.current.scrollHeight)},[C]),m.useEffect(()=>{F.current&&F.current.scrollTo({top:F.current.scrollHeight,behavior:"smooth"})},[C]),m.useEffect(()=>{if(F.current&&E){const t=setInterval(()=>{try{const c=F.current;c.scrollTop=c.scrollHeight}catch{}},150);return()=>clearInterval(t)}},[E,C]),m.useEffect(()=>{const t=c=>{we.current&&!we.current.contains(c.target)&&me(!1)};return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[]),m.useEffect(()=>{const t=c=>{c.key==="Escape"&&I&&G(!1)};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[I]),m.useEffect(()=>(I&&window.innerWidth<768?(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"):(document.body.style.overflow="",document.body.style.paddingRight=""),()=>{document.body.style.overflow="",document.body.style.paddingRight=""}),[I]),m.useEffect(()=>{const t=()=>{window.innerWidth>=768&&I&&(console.log("Desktop-a ke√ßildi, sidebar baƒülanƒ±r"),G(!1))};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[I]),e.jsx("div",{className:`${w.isDarkMode?"dark":""}`,children:e.jsxs("div",{className:"min-h-screen flex flex-col overflow-x-hidden",style:{background:w.isDarkMode?"linear-gradient(135deg, #1f2937 0%, #111827 100%)":b?.background_gradient||"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",backgroundAttachment:"fixed"},children:[e.jsx(kt,{title:`∆èsas s…ôhif…ô - ${ye}`}),e.jsxs("div",{className:"w-full px-4 md:px-4 lg:px-6 py-4 md:py-4 lg:py-6 flex-1 pb-0",children:[e.jsxs(p.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"mb-4 md:mb-6 flex flex-wrap items-center justify-between bg-gradient-to-r from-white/95 via-white/90 to-white/95 dark:from-gray-800/95 dark:via-gray-800/90 dark:to-gray-800/95 backdrop-blur-xl rounded-3xl p-4 md:p-6 shadow-2xl shadow-purple-500/10 dark:shadow-purple-500/20 w-full border border-white/20 dark:border-gray-700/50 hover:shadow-3xl transition-all duration-300",children:[e.jsxs(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},className:"flex items-start md:items-center gap-3",children:[e.jsx(p.button,{whileHover:{scale:1.05,rotate:5},whileTap:{scale:.95},onClick:t=>{t.preventDefault(),t.stopPropagation(),console.log("Toggle button clicked:",!I),G(!I)},onTouchStart:t=>{t.preventDefault(),t.stopPropagation(),console.log("Toggle touch start")},onTouchEnd:t=>{t.preventDefault(),t.stopPropagation();const c=!I;console.log("Toggle touch end, changing state from",I,"to",c),G(c)},className:"md:hidden p-3 rounded-xl bg-gradient-to-br from-purple-500/10 to-indigo-500/10 text-gray-700 dark:text-gray-300 hover:from-purple-500/20 hover:to-indigo-500/20 border border-purple-200/30 dark:border-purple-700/30 backdrop-blur-sm transition-all duration-300 shadow-lg hover:shadow-xl","aria-label":"S√∂hb…ôt tarix√ß…ôsi",type:"button",style:{touchAction:"manipulation",WebkitTouchCallout:"none",WebkitUserSelect:"none"},children:e.jsx(u,{name:"menu",size:20})}),e.jsxs(p.h1,{initial:{opacity:0,x:-15},animate:{opacity:1,x:0},transition:{duration:.6,delay:.3},className:"hidden md:flex text-lg md:text-2xl lg:text-3xl font-bold bg-gradient-to-r from-gray-800 via-gray-700 to-gray-800 dark:from-gray-100 dark:via-gray-200 dark:to-gray-100 bg-clip-text text-transparent items-center gap-3 hover:from-purple-600 hover:via-indigo-600 hover:to-purple-600 transition-all duration-500",children:[s.brand_mode==="logo"&&(be||s.brand_logo_url)?e.jsx(p.img,{whileHover:{scale:1.1,rotate:5},src:be||s.brand_logo_url,alt:"logo",className:"w-8 h-8 md:w-10 md:h-10 object-contain rounded-xl shadow-lg border border-white/20 dark:border-gray-700/50"}):s.brand_mode==="icon"?e.jsx(p.div,{whileHover:{scale:1.1,rotate:5},className:"p-2 rounded-xl bg-gradient-to-br from-purple-500/10 to-indigo-500/10 border border-purple-200/30 dark:border-purple-700/30 shadow-lg",children:e.jsx(u,{name:s.brand_icon_name||"nav_chat",size:28,color:M})}):null,e.jsx(p.span,{whileHover:{scale:1.02},className:"truncate font-extrabold tracking-wide",children:ye})]}),e.jsxs("div",{className:"md:hidden flex flex-col gap-1 ml-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[12px] font-medium text-gray-700 dark:text-gray-300",ref:we,children:[e.jsx(u,{name:"limit",size:18}),e.jsxs("span",{children:[q.limit_type==="monthly"?"Aylƒ±q":"G√ºnl√ºk"," limitiniz"]}),e.jsx("span",{className:"text-white px-2 py-0.5 rounded-full",style:{backgroundColor:M},children:q.remaining})," sorƒüu",e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),$e(t.currentTarget),me(c=>!c)},className:"ml-1 p-1 rounded-md text-gray-800 hover:text-black hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:scale-110",title:"Limit haqqƒ±nda",children:e.jsx(u,{name:"limit_info",size:18})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{name:"sun",size:16,color:w.isDarkMode?"#9ca3af":"#fbbf24"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:w.isDarkMode,onChange:()=>w.toggleDarkMode(),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),e.jsx(u,{name:"moon",size:16,color:w.isDarkMode?"#60a5fa":"#9ca3af"})]})]})]}),e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.4},className:"hidden md:flex items-center gap-3 flex-wrap justify-end",children:[e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:`relative px-4 py-2 rounded-xl text-xs font-semibold backdrop-blur-sm border shadow-lg transition-all duration-300 ${te?"bg-gradient-to-r from-red-50 to-red-100 text-red-800 border-red-200 shadow-red-200/50":q.remaining<=5?"bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-800 border-yellow-200 shadow-yellow-200/50":"bg-gradient-to-r from-green-50 to-green-100 text-green-800 border-green-200 shadow-green-200/50"}`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:te?"warning":"limit",size:12}),e.jsx("span",{children:te?e.jsxs(e.Fragment,{children:["M…ôhdudiyy…ôt! - ",He(re)]}):e.jsxs(e.Fragment,{children:[q.limit_type==="monthly"?"Aylƒ±q":"G√ºnl√ºk"," limitiniz ",q.remaining," sorƒüu(√ßƒ±xƒ±≈ü)"]})}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),$e(t.currentTarget),me(c=>!c)},className:"ml-1 p-1 rounded-md text-gray-800 hover:text-black hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:scale-110",title:"Limit haqqƒ±nda",children:e.jsx(u,{name:"limit_info",size:18})})]})}),e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsx(u,{name:"sun",size:16,color:w.isDarkMode?"#9ca3af":"#fbbf24"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:w.isDarkMode,onChange:()=>w.toggleDarkMode(),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),e.jsx(u,{name:"moon",size:16,color:w.isDarkMode?"#60a5fa":"#9ca3af"})]}),d?.user?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"hidden md:inline text-sm text-gray-600 dark:text-gray-300",children:["Salam, ",d.user.name]}),d.user.role?.name==="admin"&&e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/admin",className:"px-4 py-2.5 rounded-xl text-sm bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:from-purple-700 hover:to-indigo-700 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[e.jsx(u,{name:"settings",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Admin Panel"})]})}),e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/profile",className:"px-4 py-2.5 rounded-xl text-sm bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 hover:from-gray-200 hover:to-gray-300 dark:from-gray-600 dark:to-gray-700 dark:text-gray-200 dark:hover:from-gray-500 dark:hover:to-gray-600 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[e.jsx(u,{name:"users",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Profil"})]})}),e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/logout",method:"post",as:"button",className:"px-4 py-2.5 rounded-xl text-sm bg-gradient-to-r from-red-500 to-red-600 text-white hover:from-red-600 hover:to-red-700 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[e.jsx(u,{name:"logout",size:16}),e.jsx("span",{className:"hidden md:inline",children:"√áƒ±xƒ±≈ü"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/login",className:"px-4 py-2.5 rounded-xl text-sm bg-white/80 backdrop-blur-sm border-2 text-emerald-700 hover:bg-emerald-50 hover:border-emerald-300 dark:bg-gray-800/80 dark:text-emerald-400 dark:hover:bg-gray-700 dark:border-gray-600 dark:hover:border-emerald-500 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",style:{borderColor:M},children:[e.jsx(u,{name:"users",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Daxil ol"})]})}),e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/register",className:"px-4 py-2.5 rounded-xl text-sm text-white font-medium transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 bg-gradient-to-r hover:scale-105",style:{background:`linear-gradient(135deg, ${M}DD, ${se||M}DD)`},children:[e.jsx(u,{name:"user_add",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Qeydiyyat"})]})})]}),e.jsxs(p.button,{whileHover:{scale:1.05,rotate:2},whileTap:{scale:.95},onClick:()=>{k(null),z([])},className:"px-4 py-2.5 rounded-xl text-sm text-white font-medium transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 bg-gradient-to-r hover:brightness-110",style:{background:`linear-gradient(135deg, ${se}DD, ${M||se}DD)`},children:[e.jsx(u,{name:"edit",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Yeni s√∂hb…ôt"})]})]}),e.jsxs("div",{className:"flex md:hidden items-center gap-2 ml-auto overflow-x-auto",children:[d?.user?e.jsxs(e.Fragment,{children:[d.user.role?.name==="admin"&&e.jsx(H,{href:"/admin",className:"px-2 py-2 rounded-lg text-sm bg-purple-600 text-white hover:bg-purple-700 transition-colors shadow-sm flex items-center gap-1",children:e.jsx(u,{name:"settings",size:16})}),e.jsx(H,{href:"/profile",className:"px-2 py-2 rounded-lg text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500 transition-colors shadow-sm flex items-center gap-1",children:e.jsx(u,{name:"users",size:16})}),e.jsx(H,{href:"/logout",method:"post",as:"button",className:"px-2 py-2 rounded-lg text-sm bg-red-500 text-white hover:bg-red-600 transition-colors shadow-sm flex items-center gap-1",children:e.jsx(u,{name:"logout",size:16})})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{href:"/login",className:"px-2 py-2 rounded-lg text-sm bg-white border text-emerald-700 hover:bg-emerald-50 dark:bg-gray-800 dark:text-emerald-400 dark:hover:bg-gray-700 transition-colors shadow-sm flex items-center gap-1",style:{borderColor:M},children:e.jsx(u,{name:"users",size:16})}),e.jsx(H,{href:"/register",className:"px-2 py-2 rounded-lg text-sm text-white transition-colors shadow-sm flex items-center gap-1",style:{backgroundColor:M},children:e.jsx(u,{name:"user_add",size:16})})]}),e.jsx("button",{onClick:()=>{k(null),z([])},className:"px-2 py-2 rounded-lg text-sm text-white transition-colors shadow-sm flex items-center gap-1",style:{backgroundColor:se},title:"Yeni s√∂hb…ôt",children:e.jsx(u,{name:"edit",size:16})})]})]}),e.jsxs("div",{className:"flex gap-0 md:gap-4 h-full",children:[e.jsx(Y,{children:I&&e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 md:hidden",onTouchStart:t=>{t.preventDefault(),G(!1)},onClick:()=>G(!1)})}),e.jsx(Y,{children:(I||window.innerWidth>=768)&&e.jsxs(p.aside,{initial:{x:window.innerWidth<768?-320:0,opacity:window.innerWidth<768?0:1},animate:{x:0,opacity:1},exit:{x:-320,opacity:0},transition:{type:"spring",stiffness:300,damping:30,mass:.8},className:`
                  fixed md:relative
                  top-0 left-0
                  h-full
                  w-80 md:w-72 lg:w-80
                  bg-gradient-to-b from-white via-white to-gray-50 dark:from-gray-800 dark:via-gray-800 dark:to-gray-900
                  backdrop-blur-xl
                  border-r border-gray-200 dark:border-gray-700
                  rounded-r-3xl md:rounded-3xl
                  z-50 md:z-auto
                  flex flex-col
                  shadow-2xl md:shadow-xl
                `,children:[e.jsxs(p.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between bg-gradient-to-r from-purple-50/30 to-indigo-50/30 dark:from-purple-900/10 dark:to-indigo-900/10 rounded-tr-3xl md:rounded-t-3xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.brand_mode==="logo"&&(be||s.brand_logo_url)?e.jsx(p.img,{whileHover:{scale:1.1,rotate:5},src:be||s.brand_logo_url,alt:"logo",className:"w-7 h-7 object-contain rounded-lg shadow-sm"}):s.brand_mode==="icon"?e.jsx(p.div,{whileHover:{scale:1.1,rotate:5},children:e.jsx(u,{name:s.brand_icon_name||"nav_chat",size:24,color:M})}):null,e.jsx("h2",{className:"text-sm font-bold text-gray-800 dark:text-gray-200 uppercase tracking-wider",children:"S√∂hb…ôt Tarix√ß…ôsi"})]}),e.jsx(p.button,{whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},onTouchStart:t=>{t.preventDefault(),t.stopPropagation(),G(!1)},onClick:t=>{t.preventDefault(),t.stopPropagation(),G(!1)},className:"md:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors active:bg-gray-200 dark:active:bg-gray-600 shadow-sm",type:"button","aria-label":"Baƒüla",children:e.jsx(u,{name:"close",size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-1 custom-scrollbar",children:[(d?.user?fe:g).map((t,c)=>e.jsx(p.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:c*.05,duration:.3},whileHover:{scale:1.02,x:4},whileTap:{scale:.98},onClick:()=>{ut(t.session_id),window.innerWidth<768&&G(!1)},className:`
                        group w-full text-left px-3 py-2.5 rounded-xl transition-all
                        ${j===t.session_id?"bg-gradient-to-r from-emerald-50 to-emerald-100/50 dark:from-gray-700 dark:to-gray-600 border-l-4 shadow-md":"hover:bg-gray-50 dark:hover:bg-gray-700/50 hover:shadow-sm"}
                      `,style:j===t.session_id?{borderLeftColor:M}:{},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:t.title||t.session_id.slice(0,8)}),!d?.user&&t.created_at&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:new Date(t.created_at).toLocaleDateString("az")})]}),e.jsx(p.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:i=>{i.stopPropagation(),_e(t),Se(!0)},className:"opacity-0 group-hover:opacity-100 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-all",title:"S√∂hb…ôti sil",children:e.jsx(u,{name:"close",size:16,className:"text-red-500"})})]})},t.session_id)),(d?.user?fe:g).length===0&&e.jsxs(p.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"text-center py-12",children:[e.jsx(u,{name:"chat",size:48,color:w.isDarkMode?"#6b7280":"#d1d5db",className:"mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"He√ß bir s√∂hb…ôt yoxdur"})]})]}),e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gradient-to-r from-purple-50/30 to-indigo-50/30 dark:from-purple-900/10 dark:to-indigo-900/10 rounded-br-3xl md:rounded-b-3xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{name:"chat",size:18,color:M}),e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"√úmumi s√∂hb…ôtl…ôr"})]}),e.jsx(p.div,{whileHover:{scale:1.15},className:"flex items-center justify-center min-w-[28px] h-7 px-2.5 rounded-full text-xs font-bold text-white shadow-lg",style:{backgroundColor:M},children:(d?.user?fe:g).length})]})})]})}),e.jsx("div",{className:"flex-1 min-w-0 w-full",children:e.jsx("main",{className:"w-full max-w-none",children:e.jsxs("div",{className:`w-full backdrop-blur-xl border border-emerald-200 dark:border-gray-600 rounded-3xl p-3 md:p-6 flex flex-col shadow-2xl hover:shadow-3xl dark:shadow-purple-500/10 border-white/20 dark:border-gray-700/30 transition-all duration-300 relative ${Te==="transparent"?"bg-white/95 dark:bg-gray-800/95":""}`,"data-chat-background":"true",id:"chat-container",style:{minHeight:"calc(100vh - 200px)",background:Te!=="transparent"?Te:void 0,backgroundSize:b?.chat_background_type==="image"?"cover":void 0,backgroundPosition:b?.chat_background_type==="image"?"center":void 0,backgroundRepeat:b?.chat_background_type==="image"?"no-repeat":void 0},children:[e.jsxs("div",{className:"absolute top-2 right-2 z-20",children:[e.jsx("button",{onClick:()=>ot(t=>!t),className:"p-2 rounded-lg bg-white/80 dark:bg-gray-700/80 border border-gray-200 dark:border-gray-600 shadow hover:shadow-md transition",title:"M…ôtn √∂l√ß√ºs√º",children:e.jsx(u,{name:"type",size:16})}),st&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 shadow-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"M…ôtn √∂l√ß√ºs√º"}),e.jsx("input",{type:"range",min:"0.85",max:"1.4",step:"0.05",value:O,onChange:t=>ue(parseFloat(t.target.value)),className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("button",{onClick:()=>ue(.95),className:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A-"}),e.jsx("button",{onClick:()=>ue(1),className:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A"}),e.jsx("button",{onClick:()=>ue(1.2),className:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A+"})]})]})]}),e.jsxs("div",{ref:F,className:"flex-1 overflow-y-auto space-y-3 pr-1 md:pr-2 custom-scrollbar",style:{maxHeight:"calc(100vh - 240px)"},children:[e.jsx(Y,{children:C.map((t,c)=>e.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.2},className:`group relative max-w-[90%] md:max-w-[85%] rounded-xl px-3 md:px-4 py-2 md:py-3 ${t.role==="user"?"ml-auto bg-emerald-50/60 dark:bg-emerald-900/20":"mr-auto bg-gray-100/60 dark:bg-gray-700/50"} shadow-lg hover:shadow-xl dark:shadow-2xl dark:hover:shadow-3xl border border-emerald-100 dark:border-gray-600 backdrop-blur-md transition-all duration-300 hover:-translate-y-0.5`,style:{},children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:t.role==="user"?e.jsx("div",{className:"flex items-center gap-2",children:d?.user?e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:M},children:d.user.name}):e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:M},children:"Siz - Qonaq"})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:se},children:Be||"AI Assistant"}),e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",title:"AI Aktiv"})]})}),t.created_at&&e.jsxs("div",{className:"text-xs text-gray-400 flex flex-col items-end",children:[e.jsx("span",{className:"hidden md:block",children:new Date(t.created_at).toLocaleDateString("az-AZ",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsx("span",{children:new Date(t.created_at).toLocaleTimeString("az-AZ",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"absolute top-1.5 right-1.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>nt(qe===(t.id||c)?null:t.id||c),className:"p-1.5 rounded-full bg-white/90 dark:bg-gray-800/90 border border-gray-200 dark:border-gray-600 shadow",title:"Mesaj m…ôtni √∂l√ß√ºs√º",children:e.jsx(u,{name:"type",size:12})}),qe===(t.id||c)&&e.jsxs("div",{className:"absolute right-0 mt-2 w-44 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 shadow-lg p-3 z-10",children:[e.jsx("div",{className:"text-[11px] font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bu mesaj √º√ß√ºn √∂l√ß√º"}),e.jsx("input",{type:"range",min:"0.85",max:"1.4",step:"0.05",value:Pe.get(t.id)??O,onChange:i=>{const l=parseFloat(i.target.value);pe(y=>{const N=new Map(y);return N.set(t.id,l),N})},className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("button",{onClick:()=>pe(i=>{const l=new Map(i);return l.set(t.id,Math.max(.85,(l.get(t.id)??O)-.05)),l}),className:"px-2 py-1 text-[11px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A-"}),e.jsx("button",{onClick:()=>pe(i=>{const l=new Map(i);return l.set(t.id,O),l}),className:"px-2 py-1 text-[11px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"Sƒ±fƒ±rla"}),e.jsx("button",{onClick:()=>pe(i=>{const l=new Map(i);return l.set(t.id,Math.min(1.4,(l.get(t.id)??O)+.05)),l}),className:"px-2 py-1 text-[11px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A+"})]})]})]}),e.jsx("div",{className:"whitespace-pre-wrap leading-relaxed text-gray-800 dark:text-gray-200",style:{fontSize:`${Pe.get(t.id)??O}rem`},children:t.role==="assistant"?Ke.has(t.id)?e.jsx(Tt,{text:t.fullContent,speed:ct,onComplete:()=>{z(i=>{const l=i.map(y=>y.id===t.id?{...y,content:t.fullContent,isTyping:!1}:y);return!d?.user&&j&&setTimeout(()=>{Re(j,null,l)},100),l}),ke(i=>{const l=new Set(i);return l.delete(t.id),l}),V(!1)}}):e.jsx(Mt,{content:t.content||""}):e.jsx("div",{className:"whitespace-pre-wrap",style:{fontSize:`${Pe.get(t.id)??O}rem`},children:t.content})}),t.role==="assistant"&&!t.isTyping&&e.jsxs("div",{className:"flex items-center justify-start md:justify-between mt-2 flex-wrap gap-1 md:gap-2",children:[(()=>{const i=String(t.id||"");return!(Ae.has(i)||X.has(t.id))})()&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Oe(String(t.id||""),t.content||t.fullContent,"like"),disabled:X.has(t.id),className:`p-1 md:p-1.5 rounded-lg transition-all group/btn ${X.get(t.id)==="like"?"text-green-600 bg-green-50 dark:bg-green-900/30":"text-gray-400 hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-900/30"} disabled:opacity-50`,title:"B…ôy…ôn",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:"heart",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:X.get(t.id)==="like"?"B…ôy…ôndiniz":"B…ôy…ôn"})]})}),e.jsx("button",{onClick:()=>Oe(String(t.id||""),t.content||t.fullContent,"dislike"),disabled:X.has(t.id),className:`p-1 md:p-1.5 rounded-lg transition-all group/btn ${X.get(t.id)==="dislike"?"text-red-600 bg-red-50 dark:bg-red-900/30":"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/30"} disabled:opacity-50`,title:"B…ôy…ônm…ô",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:"dislike",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:X.get(t.id)==="dislike"?"B…ôy…ônm…ôdiniz":"B…ôy…ônm…ô"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-75 hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t.content||t.fullContent),r.success("M…ôtn kopyalandƒ±!")},className:"p-1 md:p-1.5 text-gray-400 hover:text-emerald-500 hover:bg-emerald-50 rounded-lg transition-all group/btn",title:"M…ôtn kopyala",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:"copy",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:"Kopyala"})]})}),e.jsx("button",{onClick:()=>{r.success("Geribildiri≈üiniz g√∂nd…ôrilir..."),(async()=>{try{const l=t.id,y=l!=null?String(l):void 0,N={message_content:t.content||t.fullContent,session_id:j,timestamp:t.created_at,user_info:d?.user?{name:d.user.name,email:d.user.email}:"Qonaq istifad…ô√ßi"};y!==void 0&&(N.message_id=y);const _=await B.post("/chat/report-feedback",N);setTimeout(()=>{r.success("Geribildiri≈üiniz g√∂nd…ôrildi!")},1e3)}catch(l){console.error("Feedback report error:",l);const y=l.response?.data?.message||l.response?.data?.error||"X…ôta ba≈ü verdi";setTimeout(()=>{r.error("Geribildiri≈ü g√∂nd…ôrilm…ôdi: "+y)},1e3)}})()},className:"p-1 md:p-1.5 text-gray-400 hover:text-orange-500 hover:bg-orange-50 rounded-lg transition-all group/btn",title:"S…ôhv cavab haqqƒ±nda bildi≈ü g√∂nd…ôr",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:"warning",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:"Bildir"})]})})]})]})]},t.id||c))}),a&&e.jsx(_t,{chatbotName:Be})]}),e.jsx("div",{className:"mt-3 md:mt-4",children:e.jsx("div",{className:"relative bg-white/50 dark:bg-gray-800/50 backdrop-blur-lg rounded-2xl border border-white/30 dark:border-gray-700/30 shadow-2xl hover:shadow-3xl transition-all duration-300 p-1",children:e.jsxs("div",{className:"relative flex items-end gap-2",children:[e.jsx("textarea",{ref:ee,className:`flex-1 bg-transparent border-none outline-none focus:outline-none focus:ring-0 resize-none text-sm md:text-base p-3 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-gray-100 min-h-[50px] max-h-[150px] ${xe&&K?"text-red-600 placeholder-red-400":""} ${R||E?"opacity-50 cursor-not-allowed":""}`,placeholder:te?`Limit doldu - ${He(re)}`:E?"√áatbot yazƒ±r... g√∂zl…ôyin":R?"ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul edin...":"Mesajƒ±nƒ±zƒ± yazƒ±n...",value:$,onChange:t=>{if(!R&&!E){const c=t.target.value;L(J>0?c.slice(0,J):c)}try{const c=ee.current;if(c){c.style.height="auto";const i=(window.innerWidth<768,150);c.style.height=Math.min(c.scrollHeight,i)+"px"}}catch{}},onInput:()=>{try{const t=ee.current;if(t){t.style.height="auto";const c=(window.innerWidth<768,150);t.style.height=Math.min(t.scrollHeight,c)+"px"}}catch{}},onKeyDown:xt,disabled:R,rows:2}),e.jsxs("div",{className:"flex items-center gap-1 pb-3 pr-1",children:[e.jsx("button",{onClick:()=>Je(!Q),className:`p-2 rounded-lg transition-all shadow-sm hover:shadow-md border backdrop-blur-sm ${Q?"bg-emerald-500/90 text-white border-emerald-400/50 shadow-emerald-500/25":"bg-white/70 dark:bg-gray-700/70 text-gray-600 dark:text-gray-300 border-gray-300/50 dark:border-gray-600/50"}`,title:Q?"Enter il…ô g√∂nd…ôr aktiv":"Enter il…ô g√∂nd…ôr deaktiv",children:e.jsx(u,{name:"enter",size:14})}),e.jsx("button",{onClick:()=>D||E?We():Ge(),disabled:xe&&K||R,className:"p-3 rounded-xl text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-all shadow-lg hover:shadow-xl hover:scale-105 backdrop-blur-sm",style:{backgroundColor:D||E||xe&&K||R?"#ef4444":M,boxShadow:`0 4px 20px ${D||E?"#ef444420":`${M}20`}`},title:D||E?"Dayandƒ±r":R?"ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul edin":"G√∂nd…ôr",children:e.jsx(u,{name:D||E?"stop":R?"shield_check":"send",size:16})})]})]})})}),xe&&e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("p",{className:`text-xs transition-all ${K?"text-red-600 font-medium":mt<50?"text-yellow-600":"text-gray-500"}`,children:["Daxiletm…ô limiti ",J," simvol",ae>0&&e.jsxs("span",{className:K?"text-red-600":"text-gray-400",children:["(istifad…ô edilib: ",ae,")"]})]}),K&&e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"‚ö†Ô∏è Limit ke√ßildi!"})]}),e.jsx("div",{className:"text-center mt-3",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 px-4 py-2 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg inline-block",children:["‚ö†Ô∏è ",dt]})}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 text-center",children:Q?e.jsxs("span",{children:[e.jsx("strong",{className:"text-gray-600 dark:text-gray-300",children:"Enter"})," - g√∂nd…ôr, ",e.jsx("strong",{className:"text-gray-600 dark:text-gray-300",children:"Shift+Enter"})," - yeni s…ôtir"]}):e.jsxs("span",{children:[e.jsx("strong",{className:"text-gray-600 dark:text-gray-300",children:"Enter"})," - yeni s…ôtir"]})})]})})})]})]}),e.jsx(vt,{footerSettings:h}),e.jsx(jt,{}),e.jsx(Nt,{isOpen:tt,onAccept:pt,onReject:yt,siteName:ye}),Ze&&wt.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999]",onClick:()=>me(!1),children:[e.jsx("div",{className:"absolute inset-0"}),e.jsxs("div",{className:"absolute w-[18rem] md:w-[20rem] p-3 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-2xl text-xs text-gray-700 dark:text-gray-200 limit-popover-animate backdrop-blur-lg",style:{top:Ee.top,left:Ee.left},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"font-semibold mb-1",children:"Limit qaydasƒ±"}),q.limit_type==="monthly"?e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:"Aylƒ±q limit 30 g√ºnd…ôn bir b…ôrpa olunur. ƒ∞lk mesaj g√∂nd…ôrdiyiniz vaxt ba≈ülanƒüƒ±c n√∂qt…ôsidir."}),e.jsx("p",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"N√ºmun…ô: ƒ∞lk mesajƒ± bu g√ºn 14:00-da g√∂nd…ôrmisinizs…ô, n√∂vb…ôti b…ôrpa 30 g√ºn sonra eyni tarix v…ô saatda olacaq."}),e.jsxs("p",{className:"mt-1",children:["N√∂vb…ôti b…ôrpa: ",q.monthly_reset_time?new Date(q.monthly_reset_time).toLocaleString("az-AZ"):"H…ôl…ô ba≈ülanmayƒ±b"]})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:"G√ºnl√ºk limit yalnƒ±z 0-a d√º≈üd√ºkd…ô 24 saatlƒ±q geri sayƒ±m ba≈ülayƒ±r."}),e.jsxs("p",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:["N√ºmun…ô: D√ºn…ôn 14:00-da istifad…ô etdiniz v…ô h…ôl…ô ",q.daily_remaining??q.remaining," qalƒ±bsa, sabah 14:00-da yenil…ônmir. 0 etdiyiniz andan 24 saat sonra b…ôrpa olacaq."]}),e.jsxs("p",{className:"mt-1",children:["N√∂vb…ôti b…ôrpa: ",q.reset_time?new Date(q.reset_time).toLocaleString("az-AZ"):"Limit bitm…ôyib"]})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"font-semibold mb-0.5",children:"‚ÄúSorƒüu‚Äù n…ôdir?"}),e.jsx("p",{children:"H…ôr g√∂nd…ôrdiyiniz mesaj 1 sorƒüudur."})]})]})]}),document.body),e.jsx(St,{isOpen:at,onConfirm:it,onCancel:lt,chatTitle:W?.title||W?.session_id?.slice(0,8)||"",siteName:ye}),e.jsx(zt,{isAuthenticated:!!d?.user})]})})}export{Wt as default};
