import{j as e,M as vt,r as wt,a as jt}from"./markdown-CGR2RDhP.js";import{a as l,L as B,b as R,H as Nt}from"./vendor-4eYsLQor.js";import{I as y}from"./Icon-4HnnCzTR.js";import{a as fe,u as Qe}from"./app-DK5cRGw_.js";import{F as St}from"./Footer-BT-VBTBm.js";import{M as _t,i as Ct,u as Ze,P as Pt,a as zt,b as Mt,L as Dt,m as N}from"./proxy-CfrAqMoI.js";import{r as It}from"./index-Cn3or5DS.js";import"./app-CvpZHLlP.js";function Je(n,o){if(typeof n=="function")return n(o);n!=null&&(n.current=o)}function Tt(...n){return o=>{let a=!1;const x=n.map(p=>{const t=Je(p,o);return!a&&typeof t=="function"&&(a=!0),t});if(a)return()=>{for(let p=0;p<x.length;p++){const t=x[p];typeof t=="function"?t():Je(n[p],null)}}}}function Lt(...n){return l.useCallback(Tt(...n),n)}class $t extends l.Component{getSnapshotBeforeUpdate(o){const a=this.props.childRef.current;if(a&&o.isPresent&&!this.props.isPresent){const x=a.offsetParent,p=Ct(x)&&x.offsetWidth||0,t=this.props.sizeRef.current;t.height=a.offsetHeight||0,t.width=a.offsetWidth||0,t.top=a.offsetTop,t.left=a.offsetLeft,t.right=p-t.width-t.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Et({children:n,isPresent:o,anchorX:a,root:x}){const p=l.useId(),t=l.useRef(null),h=l.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:C}=l.useContext(_t),_=Lt(t,n?.ref);return l.useInsertionEffect(()=>{const{width:u,height:w,top:f,left:j,right:b}=h.current;if(o||!t.current||!u||!w)return;const P=a==="left"?`left: ${j}`:`right: ${b}`;t.current.dataset.motionPopId=p;const k=document.createElement("style");C&&(k.nonce=C);const z=x??document.head;return z.appendChild(k),k.sheet&&k.sheet.insertRule(`
          [data-motion-pop-id="${p}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${w}px !important;
            ${P}px !important;
            top: ${f}px !important;
          }
        `),()=>{z.contains(k)&&z.removeChild(k)}},[o]),e.jsx($t,{isPresent:o,childRef:t,sizeRef:h,children:l.cloneElement(n,{ref:_})})}const At=({children:n,initial:o,isPresent:a,onExitComplete:x,custom:p,presenceAffectsLayout:t,mode:h,anchorX:C,root:_})=>{const u=Ze(Rt),w=l.useId();let f=!0,j=l.useMemo(()=>(f=!1,{id:w,initial:o,isPresent:a,custom:p,onExitComplete:b=>{u.set(b,!0);for(const P of u.values())if(!P)return;x&&x()},register:b=>(u.set(b,!1),()=>u.delete(b))}),[a,u,x]);return t&&f&&(j={...j}),l.useMemo(()=>{u.forEach((b,P)=>u.set(P,!1))},[a]),l.useEffect(()=>{!a&&!u.size&&x&&x()},[a]),h==="popLayout"&&(n=e.jsx(Et,{isPresent:a,anchorX:C,root:_,children:n})),e.jsx(Pt.Provider,{value:j,children:n})};function Rt(){return new Map}const be=n=>n.key||"";function Ke(n){const o=[];return l.Children.forEach(n,a=>{l.isValidElement(a)&&o.push(a)}),o}const ge=({children:n,custom:o,initial:a=!0,onExitComplete:x,presenceAffectsLayout:p=!0,mode:t="sync",propagate:h=!1,anchorX:C="left",root:_})=>{const[u,w]=zt(h),f=l.useMemo(()=>Ke(n),[n]),j=h&&!u?[]:f.map(be),b=l.useRef(!0),P=l.useRef(f),k=Ze(()=>new Map),[z,L]=l.useState(f),[I,$]=l.useState(f);Mt(()=>{b.current=!1,P.current=f;for(let d=0;d<I.length;d++){const S=be(I[d]);j.includes(S)?k.delete(S):k.get(S)!==!0&&k.set(S,!1)}},[I,j.length,j.join("-")]);const s=[];if(f!==z){let d=[...f];for(let S=0;S<I.length;S++){const H=I[S],U=be(H);j.includes(U)||(d.splice(S,0,H),s.push(H))}return t==="wait"&&s.length&&(d=s),$(Ke(d)),L(f),null}const{forceRender:i}=l.useContext(Dt);return e.jsx(e.Fragment,{children:I.map(d=>{const S=be(d),H=h&&!u?!1:f===I||j.includes(S),U=()=>{if(k.has(S))k.set(S,!0);else return;let W=!0;k.forEach(ke=>{ke||(W=!1)}),W&&(i?.(),$(P.current),h&&w?.(),x&&x())};return e.jsx(At,{isPresent:H,initial:!b.current||a?void 0:!1,custom:o,presenceAffectsLayout:p,mode:t,root:_,onExitComplete:H?void 0:U,anchorX:C,children:d},S)})})},qt=({className:n=""})=>{const{isDarkMode:o}=fe(),[a,x]=l.useState(null),[p,t]=l.useState(!0),[h,C]=l.useState(!1),[_,u]=l.useState(!1);l.useEffect(()=>{const b=localStorage.getItem("donation_dismissed_until"),P=Date.now();if(b&&P<parseInt(b)){u(!0),t(!1);return}w()},[]);const w=async()=>{try{const P=await(await fetch("/api/donation-settings")).json();P&&P.enabled&&(x(P),setTimeout(()=>{C(!0)},2e3))}catch(b){console.error("Error fetching donation settings:",b)}finally{t(!1)}},f=()=>{u(!0),C(!1)},j=()=>{const b=Date.now()+6048e5;localStorage.setItem("donation_dismissed_until",b.toString()),u(!0),C(!1)};return p||!a||_?null:e.jsx(ge,{children:h&&e.jsx(N.div,{className:"fixed inset-0 backdrop-blur-lg flex items-center justify-center z-50 p-4 modal-overlay",style:{background:o?"linear-gradient(135deg, rgba(31, 41, 55, 0.85) 0%, rgba(17, 24, 39, 0.9) 100%) !important":"linear-gradient(135deg, rgba(249, 250, 251, 0.85) 0%, rgba(255, 255, 255, 0.9) 100%) !important"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},onClick:()=>C(!1),children:e.jsxs(N.div,{className:`max-w-md w-full rounded-3xl shadow-2xl relative overflow-hidden border-2 backdrop-blur-md modal-content donation-modal ${o?"dark":""} ${o?"border-gray-600/50":"border-gray-200/50"}`,style:{background:a.background_color||(o?"linear-gradient(135deg, rgba(31, 41, 55, 0.95) 0%, rgba(17, 24, 39, 0.98) 100%) !important":"linear-gradient(135deg, rgba(249, 250, 251, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%) !important"),color:a.text_color||(o?"#ffffff !important":"#333333 !important"),backdropFilter:"blur(20px)",boxShadow:o?"0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05)":"0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.1)"},initial:{scale:.8,opacity:0,y:50,rotateX:15},animate:{scale:1,opacity:1,y:0,rotateX:0},exit:{scale:.8,opacity:0,y:50,rotateX:15},transition:{type:"spring",damping:25,stiffness:300,duration:.5},whileHover:{scale:1.02,y:-5},onClick:b=>b.stopPropagation(),children:[e.jsx(N.button,{onClick:f,className:`absolute top-5 right-5 w-10 h-10 flex items-center justify-center rounded-full transition-all duration-300 z-10 text-xl font-medium ${o?"bg-gray-700/70 hover:bg-gray-600/80 text-gray-300 hover:text-white border border-gray-600/50":"bg-gray-100/70 hover:bg-gray-200/80 text-gray-600 hover:text-gray-800 border border-gray-200/50"}`,whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},children:"√ó"}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(N.h3,{className:"text-2xl font-bold mb-6 pr-10 leading-tight",style:{color:a.text_color||(o?"#ffffff":"#333333")},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:a.title}),e.jsx(N.div,{className:`text-base leading-relaxed prose max-w-none ${o?"dark:prose-invert":""}`,style:{color:a.text_color||(o?"#ffffff":"#333333"),"--tw-prose-body":a.text_color||(o?"#ffffff":"#333333"),"--tw-prose-headings":a.text_color||(o?"#ffffff":"#333333"),"--tw-prose-bold":a.text_color||(o?"#ffffff":"#333333"),"--tw-prose-links":a.text_color||(o?"#ffffff":"#333333")},dangerouslySetInnerHTML:{__html:a.content},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2}})]}),e.jsxs(N.div,{className:"space-y-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(N.div,{className:"flex-1",children:e.jsx(B,{href:"/donation",className:"w-full block px-6 py-4 rounded-xl font-bold text-white text-center transition-all duration-300 shadow-lg",style:{backgroundColor:a.button_color||"#3b82f6"},onMouseEnter:b=>{b.target.style.filter="brightness(110%)",b.target.style.transform="translateY(-2px)",b.target.style.boxShadow="0 20px 40px rgba(0,0,0,0.2)"},onMouseLeave:b=>{b.target.style.filter="brightness(100%)",b.target.style.transform="translateY(0px)",b.target.style.boxShadow="0 10px 25px rgba(0,0,0,0.1)"},children:"üíù D…ôst…ôk Ol"})}),e.jsx(N.button,{className:`px-6 py-4 rounded-xl font-medium transition-all duration-300 hover:shadow-md backdrop-blur-sm ${o?"text-gray-300 border border-gray-600/60 hover:bg-gray-700/60 hover:border-gray-500":"text-gray-600 border border-gray-300/60 hover:bg-gray-50/60 hover:border-gray-400"}`,onClick:f,whileHover:{scale:1.05},whileTap:{scale:.95},children:"Baƒüla"})]}),e.jsx(N.button,{className:`w-full text-sm underline transition-colors py-2 rounded-lg ${o?"text-gray-400 hover:text-gray-200 hover:bg-gray-700/30":"text-gray-500 hover:text-gray-700 hover:bg-gray-100/30"}`,onClick:j,whileHover:{scale:1.02},children:"1 h…ôft…ô g√∂st…ôrm…ô"})]})]})]})})})},Bt=({isOpen:n,onAccept:o,onReject:a,siteName:x="XIV AI"})=>{const{theme:p}=fe(),[t,h]=l.useState(!1),[C,_]=l.useState(null),[u,w]=l.useState(!0),f=async()=>{try{const b=await(await fetch("/api/guest-terms")).json();_(b)}catch{console.warn("Failed to fetch admin terms, using fallback"),_({title:"ƒ∞stifad…ô ≈û…ôrtl…ôri",content:"<p>ƒ∞stifad…ô ≈ü…ôrtl…ôri y√ºkl…ônm…ôdi.</p>"})}finally{w(!1)}};return l.useEffect(()=>{n&&!C&&f()},[n]),l.useEffect(()=>(n?(h(!0),document.body.style.overflow="hidden"):document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[n]),n?e.jsx(ge,{children:t&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 bg-black/70 backdrop-blur-md",onClick:()=>a&&a()}),e.jsxs(N.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,type:"spring",stiffness:300,damping:25},className:"relative z-50 bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full mx-4 max-h-[90vh] overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 text-white",style:{background:p?.primary_color?`linear-gradient(135deg, ${p.primary_color} 0%, ${p.secondary_color||p.primary_color} 100%)`:"linear-gradient(135deg, #10b981 0%, #065f46 100%)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(y,{name:"shield_check",size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:u?"ƒ∞stifad…ô ≈û…ôrtl…ôri":C?.title||"ƒ∞stifad…ô ≈û…ôrtl…ôri"}),e.jsx("p",{className:"text-blue-100 text-sm",children:x})]})]})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-96",children:u?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Y√ºkl…ônir..."})]}):e.jsx("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:C?.content||"<p>ƒ∞stifad…ô ≈ü…ôrtl…ôri y√ºkl…ônm…ôdi.</p>"}})})}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-600 flex gap-3",style:{background:p?.primary_color?`linear-gradient(135deg, ${p.primary_color}15 0%, ${p.secondary_color||p.primary_color}15 100%)`:"linear-gradient(135deg, #10b98115 0%, #065f4615 100%)"},children:[e.jsxs("button",{onClick:a,className:"flex-1 px-4 py-3 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors flex items-center justify-center gap-2",children:[e.jsx(y,{name:"close",size:16}),e.jsx("span",{children:"R…ôdd et"})]}),e.jsxs("button",{onClick:o,className:"flex-1 px-4 py-3 text-white rounded-lg font-medium transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl",style:{background:p?.primary_color?`linear-gradient(135deg, ${p.primary_color} 0%, ${p.secondary_color||p.primary_color} 100%)`:"linear-gradient(135deg, #10b981 0%, #065f46 100%)",filter:"brightness(1)",":hover":{filter:"brightness(1.1)"}},onMouseEnter:j=>j.target.style.filter="brightness(1.1)",onMouseLeave:j=>j.target.style.filter="brightness(1)",children:[e.jsx(y,{name:"shield_check",size:16}),e.jsx("span",{children:"Q…ôbul edir…ôm"})]})]})]})]})}):null},Ft=({isOpen:n,onConfirm:o,onCancel:a,chatTitle:x="",siteName:p=""})=>{const{theme:t}=fe();return n?e.jsx(ge,{children:e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 bg-black/70 backdrop-blur-md",onClick:a}),e.jsxs(N.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,type:"spring",stiffness:300,damping:25},className:"relative z-50 bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 text-white",style:{background:t?.primary_color?`linear-gradient(135deg, ${t.primary_color} 0%, ${t.secondary_color||t.primary_color} 100%)`:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(y,{name:"warning",size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"S√∂hb…ôti Sil"}),e.jsx("p",{className:"text-blue-100 text-sm",children:p})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-gray-700 dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e.jsx(y,{name:"warning",size:24,color:"#ef4444"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-gray-900 dark:text-gray-100",children:"Bu s√∂hb…ôti silm…ôk ist…ôdiyinizd…ôn …ôminsiz?"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Bu …ôm…ôl geri alƒ±na bilm…ôz."})]})]}),x&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Silin…ôc…ôk s√∂hb…ôt:"}),e.jsxs("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:['"',x,'"']})]})]})}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-600 flex gap-3",style:{background:t?.primary_color?`linear-gradient(135deg, ${t.primary_color}10 0%, ${t.secondary_color||t.primary_color}10 100%)`:"linear-gradient(135deg, #ef444415 0%, #dc262615 100%)"},children:[e.jsxs("button",{onClick:a,className:"flex-1 px-4 py-3 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors flex items-center justify-center gap-2",children:[e.jsx(y,{name:"close",size:16}),e.jsx("span",{children:"L…ôƒüv et"})]}),e.jsxs("button",{onClick:o,className:"flex-1 px-4 py-3 text-white rounded-lg font-medium transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl bg-red-500 hover:bg-red-600",children:[e.jsx(y,{name:"delete",size:16}),e.jsx("span",{children:"Sil"})]})]})]})]})}):null},Ht=({className:n="",chatbotName:o="AI Assistant"})=>e.jsxs("div",{className:`flex items-center space-x-1 ${n}`,children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 mr-2",children:o}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]}),Gt=({isOpen:n,onClose:o,isAuthenticated:a=!1})=>{const[x,p]=l.useState("color"),[t,h]=l.useState({type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null}),[C,_]=l.useState(!1),u=Qe(),w=(s,i)=>{const d=document.querySelector("#chat-container, [data-chat-background]");d&&i&&(console.log("Applying color preview:",{type:s,value:i}),d.style.setProperty("background-image","","important"),d.style.setProperty("background-size","","important"),d.style.setProperty("background-position","","important"),d.style.setProperty("background-repeat","","important"),d.style.setProperty("background-color","","important"),d.style.setProperty("background","","important"),d.style.setProperty("background-attachment","","important"),d.style.setProperty("background-origin","","important"),d.style.setProperty("background-clip","","important"),setTimeout(()=>{s==="solid"?(d.style.setProperty("background-color",i,"important"),d.style.setProperty("background-image","none","important"),d.style.setProperty("background","none","important"),d.style.setProperty("background-size","auto","important"),d.style.setProperty("background-position","0% 0%","important"),d.style.setProperty("background-repeat","repeat","important"),d.style.setProperty("background-attachment","scroll","important"),d.style.setProperty("background-origin","padding-box","important"),d.style.setProperty("background-clip","border-box","important"),console.log("Applied solid color preview:",i),setTimeout(()=>{console.log("Solid color verification:",{backgroundColor:d.style.backgroundColor,background:d.style.background,backgroundImage:d.style.backgroundImage,computedStyles:window.getComputedStyle(d).background})},100)):s==="gradient"&&(d.style.setProperty("background",i,"important"),d.style.setProperty("background-color","","important"),console.log("Applied gradient preview:",i)),window.dispatchEvent(new CustomEvent("backgroundChanged",{detail:{type:s,background:i}}))},10))};l.useEffect(()=>{n&&f()},[n,a]),l.useEffect(()=>{t&&t.type&&a&&(console.log("Settings changed, applying background:",t.type),k())},[t.type,t.color,t.gradient,t.image,a]),l.useEffect(()=>{n&&t&&t.type&&(console.log("Modal opened, applying preview for type:",t.type),t.type==="solid"?w("solid",t.color||"#f3f4f6"):t.type==="gradient"?w("gradient",t.gradient||"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"):t.type==="image"&&t.image&&z(t))},[n,t.type,t.color,t.gradient,t.image]);const f=async()=>{console.log("loadCurrentSettings called, isAuthenticated:",a);try{let s=null;if(a){console.log("Loading settings from API...");const i=await R.get("/api/user/background-settings");console.log("API response:",i.data),i.data.success?(s=i.data.settings,console.log("Loaded settings from API:",s),h(s)):(console.warn("API returned success=false"),s={type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null,imageSize:"cover",imagePosition:"center"},h(s))}else{console.log("Loading settings from cookies...");const i=j("guest_background_settings");if(console.log("Cookie settings:",i),i)try{s=JSON.parse(i),console.log("Parsed cookie settings:",s),h(s)}catch(d){console.warn("Failed to parse guest background settings:",d),s={type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null},h(s)}else s={type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null},h(s)}console.log("Setting active tab based on settings type:",s?.type),s&&s.type==="image"?(console.log("Setting active tab to image because type is image"),p("image")):(console.log("Setting active tab to color because type is solid/gradient:",s?.type),p("color"))}catch(s){console.error("Error loading background settings:",s),h({type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null}),p("color")}},j=s=>{const d=`; ${document.cookie}`.split(`; ${s}=`);return d.length===2?d.pop().split(";").shift():null},b=(s,i,d)=>{const S=new Date;S.setTime(S.getTime()+d*24*60*60*1e3),document.cookie=`${s}=${i};expires=${S.toUTCString()};path=/`},P=async()=>{console.log("handleSave called with settings:",t),_(!0);try{if(a){const s={type:t.type,color:t.type==="solid"?t.color:null,gradient:t.type==="gradient"?t.gradient:null,image:t.type==="image"?t.image:null,imageSize:t.type==="image"?t.imageSize:null,imagePosition:t.type==="image"?t.imagePosition:null};console.log("Sending save data:",s),console.log("Current settings:",t);const i=await R.post("/api/user/background-settings",s);console.log("Save response:",i.data),console.log("Current settings after save:",t),i.data.success?(u.success("Arxa fon parametrl…ôri saxlanƒ±ldƒ±!"),k(),o()):(console.log("Save failed:",i.data),u.error("X…ôta ba≈ü verdi!"))}else b("guest_background_settings",JSON.stringify(t),70),u.success("Arxa fon parametrl…ôri saxlanƒ±ldƒ±!"),k(),o()}catch(s){console.error("Save error:",s),u.error("Saxlama zamanƒ± x…ôta ba≈ü verdi!")}finally{_(!1)}},k=()=>{console.log("applyBackground called with settings:",t);const s=document.querySelector("#chat-container, [data-chat-background]");if(console.log("Chat container found:",s),s){let i="";switch(t.type){case"solid":i=t.color||"#f3f4f6",console.log("Solid color background style:",i);break;case"gradient":i=t.gradient,console.log("Gradient background style:",i);break;case"image":if(t.image){let d=t.image;!d.startsWith("http")&&!d.startsWith("/")&&(d="/"+d),i=`url(${d})`,s.style.backgroundSize=t.imageSize||"cover",s.style.backgroundPosition=t.imagePosition||"center",s.style.backgroundRepeat="no-repeat",console.log("Applied image background:",{url:d,size:t.imageSize||"cover",position:t.imagePosition||"center"})}else i=t.color||"#f3f4f6";break;default:i="#f3f4f6"}console.log("Applying background style:",i),t.type==="image"?(s.style.setProperty("background-image",i,"important"),s.style.setProperty("background-size",t.imageSize||"cover","important"),s.style.setProperty("background-position",t.imagePosition||"center","important"),s.style.setProperty("background-repeat","no-repeat","important"),s.style.setProperty("background-color","","important")):(s.style.setProperty("background-image","","important"),s.style.setProperty("background-size","","important"),s.style.setProperty("background-position","","important"),s.style.setProperty("background-repeat","","important"),t.type==="gradient"?(s.style.setProperty("background",i,"important"),s.style.setProperty("background-color","","important")):t.type==="solid"?(s.style.setProperty("background","none","important"),s.style.setProperty("background-image","none","important"),s.style.setProperty("background-size","auto","important"),s.style.setProperty("background-position","0% 0%","important"),s.style.setProperty("background-repeat","repeat","important"),s.style.setProperty("background-attachment","scroll","important"),s.style.setProperty("background-origin","padding-box","important"),s.style.setProperty("background-clip","border-box","important"),s.style.setProperty("background-color",i,"important"),console.log("Applied solid color with full reset:",i)):(s.style.setProperty("background-color",i,"important"),s.style.setProperty("background","","important"))),window.dispatchEvent(new CustomEvent("backgroundChanged",{detail:{type:t.type,background:i,imageSize:t.imageSize,imagePosition:t.imagePosition}}))}else console.error("Chat container not found! Available elements:"),console.log("Elements with id chat-container:",document.querySelectorAll("#chat-container")),console.log("Elements with data-chat-background:",document.querySelectorAll("[data-chat-background]")),console.log("All divs on page:",document.querySelectorAll("div").length),console.log("Page body classes:",document.body.className)},z=s=>{const i=document.querySelector("#chat-container, [data-chat-background]");if(i&&s.image){let d=s.image;!d.startsWith("http")&&!d.startsWith("/")&&(d="/"+d),i.style.setProperty("background","","important"),i.style.setProperty("background-color","","important"),i.style.setProperty("background-image",`url(${d})`,"important"),i.style.setProperty("background-size",s.imageSize||"cover","important"),i.style.setProperty("background-position",s.imagePosition||"center","important"),i.style.setProperty("background-repeat","no-repeat","important"),console.log("Applied persistent preview:",{url:d,size:s.imageSize||"cover",position:s.imagePosition||"center"})}},L=async()=>{if(console.log("Delete image called, current settings:",t),!t.image){console.log("No image to delete");return}_(!0);try{console.log("Sending delete request to /api/user/background-image");const s=await R.delete("/api/user/background-image",{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(console.log("Delete response:",s.data),s.data.success){h(d=>({...d,image:null,imageSize:"cover",imagePosition:"center",type:"solid",color:"#f3f4f6"})),p("color");const i=document.querySelector("#chat-container, [data-chat-background]");i&&(i.style.setProperty("background","none","important"),i.style.setProperty("background-image","none","important"),i.style.setProperty("background-size","auto","important"),i.style.setProperty("background-position","0% 0%","important"),i.style.setProperty("background-repeat","repeat","important"),i.style.setProperty("background-attachment","scroll","important"),i.style.setProperty("background-origin","padding-box","important"),i.style.setProperty("background-clip","border-box","important"),i.style.setProperty("background-color","#f3f4f6","important")),u.success("≈û…ôkil silindi!")}else u.error("≈û…ôkil silin…ôrk…ôn x…ôta ba≈ü verdi!")}catch(s){console.error("Delete error:",s),u.error("≈û…ôkil silin…ôrk…ôn x…ôta ba≈ü verdi!")}finally{_(!1)}},I=async s=>{if(!s)return;if(s.size>400*1024){u.error("≈û…ôkil √∂l√ß√ºs√º 400KB-dan b√∂y√ºk ola bilm…ôz!");return}_(!0);const i=new FormData;i.append("image",s);try{const d=await R.post("/api/user/upload-background-image",i,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(d.data.success){console.log("Upload successful, URL:",d.data.url);const S={...t,image:d.data.url,imageSize:"cover",imagePosition:"center",type:"image"};h(S),z(S),u.success("≈û…ôkil y√ºkl…ôndi!")}else console.log("Upload failed:",d.data),u.error("≈û…ôkil y√ºkl…ônm…ôdi!")}catch(d){console.error("Upload error:",d),console.error("Upload error response:",d.response),d.response&&console.error("Upload error data:",d.response.data),u.error("≈û…ôkil y√ºkl…ônm…ô x…ôtasƒ±!")}finally{_(!1)}},$=[{name:"G√∂y-B…ôn√∂v≈ü…ôyi",value:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},{name:"√á…ôhrayƒ±-Narƒ±ncƒ±",value:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"},{name:"Ya≈üƒ±l-Mavi",value:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"},{name:"Qƒ±zƒ±l-Narƒ±ncƒ±",value:"linear-gradient(135deg, #ffa751 0%, #ff6b6b 100%)"},{name:"B…ôn√∂v≈ü…ôyi-√á…ôhrayƒ±",value:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"},{name:"T√ºnd Mavi",value:"linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)"}];return n?e.jsx(ge,{children:e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(N.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Arxa Fon Parametrl…ôri"}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(y,{name:"close",size:20})})]}),e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>{p("color"),t.type==="image"&&h(s=>({...s,type:"solid"}))},className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${x==="color"?"text-purple-600 border-b-2 border-purple-600 bg-purple-50 dark:bg-purple-900/20":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:"R…ông & Gradient"}),e.jsxs("button",{onClick:()=>{p("image"),t.image&&(h(s=>({...s,type:"image"})),z(t))},disabled:!a,className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${x==="image"&&a?"text-purple-600 border-b-2 border-purple-600 bg-purple-50 dark:bg-purple-900/20":a?"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200":"text-gray-300 dark:text-gray-600 cursor-not-allowed"}`,children:["≈û…ôkil ",!a&&"üîí"]})]}),e.jsxs("div",{className:"p-6",children:[x==="color"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{console.log("Solid color selected");const s={...t,type:"solid"};h(s),w("solid",t.color||"#f3f4f6")},className:`flex-1 p-3 rounded-lg border-2 text-sm font-medium transition-all ${t.type==="solid"?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:"Solid R…ông"}),e.jsx("button",{onClick:()=>{console.log("Gradient selected");const s={...t,type:"gradient"};h(s),w("gradient",t.gradient||"linear-gradient(135deg, #667eea 0%, #764ba2 100%)")},className:`flex-1 p-3 rounded-lg border-2 text-sm font-medium transition-all ${t.type==="gradient"?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:"Gradient"})]}),t.type==="solid"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"R…ông se√ßin"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"color",value:t.color,onChange:s=>{console.log("Color changed to:",s.target.value);const i={...t,color:s.target.value,type:"solid"};h(i),w("solid",s.target.value)},className:"w-16 h-12 rounded-lg border-2 border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:t.color,onChange:s=>{console.log("Color text changed to:",s.target.value);const i={...t,color:s.target.value,type:"solid"};h(i),w("solid",s.target.value)},className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"#f3f4f6"})]})]}),t.type==="gradient"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"X√ºsusi Gradient CSS"}),e.jsx("textarea",{value:t.gradient,onChange:s=>{console.log("Gradient changed to:",s.target.value);const i={...t,gradient:s.target.value,type:"gradient"};h(i),w("gradient",s.target.value)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-mono text-sm h-20",placeholder:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hazƒ±r Gradientl…ôr"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:$.map((s,i)=>e.jsx("button",{onClick:()=>{const d={...t,gradient:s.value,type:"gradient"};h(d),w("gradient",s.value)},className:"text-xs px-3 py-2 border rounded-lg text-left hover:opacity-80 transition-opacity text-white font-medium",style:{background:s.value},children:s.name},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"√ñnizl…ôm…ô"}),e.jsx("div",{className:"w-full h-20 rounded-lg border-2 border-gray-200 flex items-center justify-center",style:{background:t.type==="solid"?t.color:t.gradient},children:e.jsx("span",{className:"bg-black/20 px-3 py-1 rounded text-white text-sm font-medium",children:"Arxa Fon N√ºmun…ôsi"})})]})]}),x==="image"&&e.jsx("div",{className:"space-y-4",children:a?e.jsxs(e.Fragment,{children:[t.image?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center bg-gray-50 dark:bg-gray-800",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üö´"}),e.jsx("span",{className:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"≈û…ôkil y√ºkl…ônib"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-500",children:"Ba≈üqa ≈ü…ôkil y√ºkl…ôm…ôk √º√ß√ºn m√∂vcud ≈ü…ôkili silin"})]}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üì∑"}),e.jsxs("label",{htmlFor:"background-image-upload",className:"cursor-pointer",children:[e.jsx("span",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:"≈û…ôkil y√ºkl…ôyin"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF (Maksimum 400KB)"}),e.jsx("input",{id:"background-image-upload",type:"file",accept:"image/*",className:"sr-only",onChange:s=>I(s.target.files[0])})]})]}),t.image&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Cari ≈û…ôkil"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-full h-40 rounded-lg border-2 border-gray-200 overflow-hidden",style:{backgroundImage:`url(${t.image})`,backgroundSize:t.imageSize||"cover",backgroundPosition:t.imagePosition||"center",backgroundRepeat:"no-repeat"},children:e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black/10",children:e.jsx("span",{className:"bg-white/90 px-2 py-1 rounded text-xs font-medium text-gray-700",children:"√ñnizl…ôm…ô"})})}),e.jsx("button",{onClick:L,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-7 h-7 flex items-center justify-center text-sm hover:bg-red-600 transition-colors",title:"≈û…ôkili sil",children:"√ó"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"≈û…ôkil √ñl√ß√ºs√º"}),e.jsx("div",{className:"flex gap-2",children:["cover","contain","auto","100% 100%"].map(s=>e.jsx("button",{onClick:()=>{const i={...t,imageSize:s};h(i),z(i)},className:`px-3 py-1 text-xs rounded-lg border transition-colors ${(t.imageSize||"cover")===s?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-gray-200 dark:border-gray-600 hover:border-gray-300 text-gray-700 dark:text-gray-300"}`,children:s==="cover"?"Doldur":s==="contain"?"Sƒ±ƒüƒ±≈üdƒ±r":s==="auto"?"Orjinal":"Uzat"},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"≈û…ôkil M√∂vqeyi"}),e.jsx("div",{className:"grid grid-cols-3 gap-1 max-w-[120px]",children:[["top left","‚ÜñÔ∏è"],["top center","‚¨ÜÔ∏è"],["top right","‚ÜóÔ∏è"],["center left","‚¨ÖÔ∏è"],["center","‚≠ï"],["center right","‚û°Ô∏è"],["bottom left","‚ÜôÔ∏è"],["bottom center","‚¨áÔ∏è"],["bottom right","‚ÜòÔ∏è"]].map(([s,i])=>e.jsx("button",{onClick:()=>{const d={...t,imagePosition:s};h(d),z(d)},className:`w-8 h-8 text-xs rounded border flex items-center justify-center transition-colors ${(t.imagePosition||"center")===s?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-600":"border-gray-200 dark:border-gray-600 hover:border-gray-300 text-gray-500"}`,title:s,children:i},s))})]})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"D…ôyi≈üiklikl…ôr real-time g√∂st…ôrilir"})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üîí"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"≈û…ôkil Y√ºkl…ôm…ô Qadaƒüandƒ±r"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"≈û…ôkil y√ºkl…ôm…ôk √º√ß√ºn hesaba daxil olmalƒ±sƒ±nƒ±z"})]})})]}),e.jsxs("div",{className:"flex gap-2 p-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:o,className:"flex-1 px-4 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"L…ôƒüv et"}),e.jsx("button",{onClick:async()=>{h({type:"default",color:"transparent",gradient:"",image:null,imageSize:"cover",imagePosition:"center"});const i=document.querySelector("#chat-container, [data-chat-background]");i&&(i.style.setProperty("background","","important"),i.style.setProperty("background-image","","important"),i.style.setProperty("background-size","","important"),i.style.setProperty("background-position","","important"),i.style.setProperty("background-repeat","","important"),i.style.setProperty("background-color","","important"),i.style.setProperty("background-attachment","","important"),i.style.setProperty("background-origin","","important"),i.style.setProperty("background-clip","","important"));try{if(_(!0),console.log("Sending reset request with current settings:",t),a){const d={type:"default",color:null,gradient:null,image:null,imageSize:null,imagePosition:null};console.log("Sending reset data to API:",d);const S=await R.post("/api/user/background-settings",d);console.log("Reset API response:",S.data),S.data.success?(console.log("Reset successful - background and file should be deleted"),u.success("Arxa fon v…ô ≈ü…ôkil sƒ±fƒ±rlandƒ±!")):(console.error("Reset failed:",S.data),u.error("Sƒ±fƒ±rlama uƒüursuz oldu!"))}else document.cookie="guest_background_settings=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",u.success("Qonaq parametrl…ôri sƒ±fƒ±rlandƒ±!");setTimeout(()=>{f()},500),o()}catch(d){console.error("Reset error details:",d),console.error("Error response:",d.response?.data),u.error("Sƒ±fƒ±rlama zamanƒ± x…ôta ba≈ü verdi: "+(d.response?.data?.message||d.message))}finally{_(!1)}},disabled:C,className:"px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 transition-colors text-sm",title:"Defolt r…ông…ô qaytar",children:"Sƒ±fƒ±rlamaq"}),e.jsx("button",{onClick:P,disabled:C,className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-lg hover:from-purple-600 hover:to-indigo-700 disabled:opacity-50 transition-colors",children:C?"Saxlanƒ±r...":"Yadda Saxla"})]})]})})}):null},Ot=({isAuthenticated:n=!1})=>{const[o,a]=l.useState(!1),[x,p]=l.useState(!1),[t,h]=l.useState({x:0,y:0}),C=l.useRef(null),_=l.useRef(null),u=64;l.useEffect(()=>{const k=()=>{const z=window.innerWidth,L=window.innerHeight,I=20;h({x:Math.min(z-u-I,z-100),y:Math.min(L/2-u/2,L-u-I)})};return k(),window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)},[]);const w=(k,z)=>{const L=window.innerWidth,I=window.innerHeight,$=10;return{x:Math.max($,Math.min(k,L-u-$)),y:Math.max($,Math.min(z,I-u-$))}},f=()=>{_.current=Date.now(),p(!0)},j=(k,z)=>{const L=w(z.point.x-u/2,z.point.y-u/2);h(L)},b=()=>{const k=Date.now()-_.current;setTimeout(()=>{p(k>150)},50)},P=()=>{x||a(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(N.div,{ref:C,drag:!0,dragMomentum:!1,dragTransition:{bounceStiffness:600,bounceDamping:20},dragElastic:.1,onDragStart:f,onDrag:j,onDragEnd:b,onClick:P,className:"fixed z-50 cursor-pointer select-none",style:{left:t.x,top:t.y},initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:260,damping:20},whileHover:{scale:1.1},whileTap:{scale:.9},whileDrag:{scale:1.05,cursor:"grabbing"},children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center backdrop-blur border border-white/20",children:e.jsx(y,{name:"settings",size:24,color:"#ffffff"})}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-purple-500 to-indigo-600 animate-ping opacity-20"})]}),e.jsx(Gt,{isOpen:o,onClose:()=>a(!1),isAuthenticated:n})]})},Ut=n=>{const a=`; ${document.cookie}`.split(`; ${n}=`);return a.length===2?a.pop().split(";").shift():null},Ye=n=>{console.log("BackgroundLoader: applyBackgroundFromSettings called",n);const o=document.querySelector("#chat-container, [data-chat-background]");if(console.log("BackgroundLoader: Chat container found:",o),!o){console.error("BackgroundLoader: Chat container not found!");return}let a="";switch(n.type){case"solid":a=n.color;break;case"gradient":a=n.gradient;break;case"image":if(n.image){let x=n.image;!x.startsWith("http")&&!x.startsWith("/")&&(x="/"+x),a=`url(${x})`,o.style.backgroundSize=n.imageSize||"cover",o.style.backgroundPosition=n.imagePosition||"center",o.style.backgroundRepeat="no-repeat",console.log("BackgroundLoader: Applied image background:",{url:x,size:n.imageSize||"cover",position:n.imagePosition||"center"})}else a=n.color||"#f3f4f6";break;default:a="#f3f4f6"}console.log("BackgroundLoader: Applying background style:",a),n.type==="image"?(o.style.backgroundImage=a,o.style.backgroundSize=n.imageSize||"cover",o.style.backgroundPosition=n.imagePosition||"center",o.style.backgroundRepeat="no-repeat",o.style.backgroundColor=""):(o.style.backgroundImage="",o.style.backgroundSize="",o.style.backgroundPosition="",o.style.backgroundRepeat="",n.type==="gradient"?(o.style.background=a,o.style.backgroundColor=""):n.type==="solid"?(o.style.setProperty("background","none","important"),o.style.setProperty("background-image","none","important"),o.style.setProperty("background-size","auto","important"),o.style.setProperty("background-position","0% 0%","important"),o.style.setProperty("background-repeat","repeat","important"),o.style.setProperty("background-attachment","scroll","important"),o.style.setProperty("background-origin","padding-box","important"),o.style.setProperty("background-clip","border-box","important"),o.style.setProperty("background-color",a,"important"),console.log("BackgroundLoader: Applied solid color with full reset:",a)):(o.style.backgroundColor=a,o.style.background=""))},$e=async(n=!1)=>{console.log("BackgroundLoader: loadUserBackground called, isAuthenticated:",n);try{if(n){console.log("BackgroundLoader: Loading from API for authenticated user");const o=await fetch("/api/user/background-settings",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(console.log("BackgroundLoader: API response status:",o.status),o.ok){const a=await o.json();console.log("BackgroundLoader: API response data:",a),a.success?Ye(a.settings):console.warn("BackgroundLoader: API returned success=false")}else console.error("BackgroundLoader: API request failed with status:",o.status)}else{const o=Ut("guest_background_settings");if(o)try{const a=JSON.parse(o);Ye(a)}catch(a){console.warn("Failed to parse guest background settings:",a)}}}catch(o){console.warn("Failed to load user background:",o)}},Wt=({text:n,speed:o=50,onComplete:a})=>{const[x,p]=l.useState(""),[t,h]=l.useState(0);return l.useEffect(()=>{p(""),h(0)},[n]),l.useEffect(()=>{if(t<n.length){const C=setTimeout(()=>{p(_=>_+n[t]),h(_=>_+1)},o);return()=>clearTimeout(C)}else t===n.length&&t>0&&a&&a()},[t,n,o,a]),e.jsx("span",{children:x})},Xt=({content:n})=>e.jsx(vt,{remarkPlugins:[jt],rehypePlugins:[wt],components:{h1:({node:o,...a})=>e.jsx("h1",{className:"text-2xl font-bold mb-1 text-gray-800 dark:text-gray-100",...a}),h2:({node:o,...a})=>e.jsx("h2",{className:"text-xl font-semibold mb-1 text-gray-800 dark:text-gray-100",...a}),h3:({node:o,...a})=>e.jsx("h3",{className:"text-lg font-medium mb-1 text-gray-700 dark:text-gray-200",...a}),h4:({node:o,...a})=>e.jsx("h4",{className:"text-base font-medium mb-1 text-gray-700 dark:text-gray-200",...a}),p:({node:o,...a})=>e.jsx("p",{className:"mb-1 leading-normal text-gray-800 dark:text-gray-200",...a}),strong:({node:o,...a})=>e.jsx("strong",{className:"font-bold text-gray-900 dark:text-gray-100",...a}),em:({node:o,...a})=>e.jsx("em",{className:"italic text-gray-800 dark:text-gray-200",...a}),ul:({node:o,...a})=>e.jsx("ul",{className:"list-disc list-inside mb-1 space-y-0.5 text-gray-800 dark:text-gray-200",...a}),ol:({node:o,...a})=>e.jsx("ol",{className:"list-decimal list-inside mb-1 space-y-0.5 text-gray-800 dark:text-gray-200",...a}),li:({node:o,...a})=>e.jsx("li",{className:"text-gray-800 dark:text-gray-200",...a}),blockquote:({node:o,...a})=>e.jsx("blockquote",{className:"border-l-4 border-emerald-400 pl-4 py-1 mb-1 bg-emerald-50 dark:bg-emerald-900/30 text-gray-700 dark:text-gray-300",...a}),code:({node:o,inline:a,...x})=>a?e.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 py-0.5 rounded text-sm font-mono text-gray-800 dark:text-gray-200",...x}):e.jsx("code",{className:"block bg-gray-100 dark:bg-gray-700 p-3 rounded-lg text-sm font-mono text-gray-800 dark:text-gray-200 overflow-x-auto",...x}),a:({node:o,...a})=>e.jsx("a",{className:"text-emerald-600 dark:text-emerald-400 hover:text-emerald-700 dark:hover:text-emerald-300 underline",target:"_blank",rel:"noopener noreferrer",...a})},children:n});function sr({auth:n,sessions:o=[],settings:a={},theme:x={},footerSettings:p={}}){const t=Qe(),{theme:h,isDarkMode:C,toggleDarkMode:_,refreshTheme:u}=fe(),w=h||x,f={...w,isDarkMode:C,toggleDarkMode:_},[j,b]=l.useState(null),[P,k]=l.useState([]),[z,L]=l.useState(""),[I,$]=l.useState(!1),[s,i]=l.useState(!1),[d,S]=l.useState([]),[H,U]=l.useState(o||[]);l.useEffect(()=>{U(o||[])},[JSON.stringify(o)]);const[W,ke]=l.useState(!0),[Ve,ve]=l.useState(new Set),[E,Z]=l.useState(!1),[we,me]=l.useState(!1),[Ee,je]=l.useState(null),[J,et]=l.useState(new Map),[tt,ue]=l.useState(!1),Ne=l.useRef(null),[Ae,rt]=l.useState({top:0,left:0,align:"left"}),Re=r=>{try{const m=r.getBoundingClientRect(),c=8,g=window.innerWidth,v=m.right+320<g,M=v?Math.max(8,m.left):Math.max(8,m.right-320),D=Math.min(window.innerHeight-200,m.bottom+c);rt({top:D,left:M,align:v?"left":"right"})}catch{}},[qe,at]=l.useState(()=>{try{const r=localStorage.getItem("feedbackGiven"),m=r?JSON.parse(r):[];return new Set(m.map(String))}catch{return new Set}}),st=r=>{try{const m=new Set(qe);m.add(String(r)),at(m),localStorage.setItem("feedbackGiven",JSON.stringify([...m]))}catch{}},q=l.useRef(null),V=l.useRef(null),[ot,Se]=l.useState(!1),[nt,_e]=l.useState(!1),[F,X]=l.useState(!0),[it,Ce]=l.useState(!1),[G,Pe]=l.useState(null),[O,pe]=l.useState(()=>{const r=Number(localStorage.getItem("messageFontScale"));return r&&r>=.85&&r<=1.4?r:1}),[lt,dt]=l.useState(!1),[ze,xe]=l.useState(new Map),[Be,ct]=l.useState(null);l.useEffect(()=>{try{localStorage.setItem("messageFontScale",String(O))}catch{}},[O]);const gt=async()=>{if(G)try{if(n?.user){const r=document.querySelector('meta[name="csrf-token"]').getAttribute("content");try{await R.delete(`/chat/${G.session_id}`,{headers:{"X-CSRF-TOKEN":r,"X-Requested-With":"XMLHttpRequest"}})}catch{await R.post(`/chat/${G.session_id}/delete`,{},{headers:{"X-CSRF-TOKEN":r,"X-Requested-With":"XMLHttpRequest"}})}U(m=>m.filter(c=>c.session_id!==G.session_id)),j===G.session_id&&(b(null),k([]))}else{const m=JSON.parse(localStorage.getItem("guestChatSessions")||"[]").filter(c=>c.session_id!==G.session_id);localStorage.setItem("guestChatSessions",JSON.stringify(m)),S(m),j===G.session_id&&(b(null),k([]))}t.success("S√∂hb…ôt silindi!")}catch(r){console.error("Delete session error:",r),t.error("S√∂hb…ôt silin…ôrk…ôn x…ôta ba≈ü verdi")}finally{Ce(!1),Pe(null)}},mt=()=>{Ce(!1),Pe(null)},[A,Me]=l.useState({allowed:!0,remaining:0,daily_remaining:0,monthly_remaining:0,reset_time:null,monthly_reset_time:null,user_type:"guest"}),[ee,De]=l.useState(!1),[te,Ie]=l.useState(null),Fe=a.chatbot_name||"AI Assistant",re=a.site_name||"XIV AI Chatbot Platform",ut=a.chat_disclaimer_text||"√áatbotun cavablarƒ±nƒ± yoxlayƒ±n, s…ôhv ed…ô bil…ôr!",K=Number(a.message_input_limit||a.guest_input_limit||500),He=a.ai_response_type||"typewriter",pt=Number(a.ai_typing_speed||50),xt=Number(a.ai_thinking_time||1e3),ye=!n?.user,ae=z.length,yt=K-ae,Y=K>0&&ae>K,T=w?.primary_color,se=w?.secondary_color;w?.accent_color,w?.background_gradient;const he=(()=>{const r=typeof window<"u"?window.innerWidth<768:!1,m=f.isDarkMode,c=a||{},g=c.brand_logo_desktop_light,v=c.brand_logo_desktop_dark,M=c.brand_logo_mobile_light,D=c.brand_logo_mobile_dark;if(r){if(m&&D)return D;if(!m&&M)return M}else{if(m&&v)return v;if(!m&&g)return g}return c.brand_logo_url||""})(),Te=(()=>{const r=w?.chat_background_type;if(!r||r==="default"||r===null)return"transparent";switch(r){case"solid":return w?.chat_background_color||"transparent";case"gradient":return w?.chat_background_gradient||"transparent";case"image":return w?.chat_background_image?`url(${w.chat_background_image})`:"transparent";default:return"transparent"}})(),Ge=r=>{if(!r)return"";const c=r-new Date;if(c<=0)return"Yenil…ônir...";const g=Math.floor(c/(1e3*60*60)),v=Math.floor(c%(1e3*60*60)/(1e3*60)),M=Math.floor(c%(1e3*60)/1e3);return g>0?`${g} saat ${v} d…ôqiq…ô ${M} saniy…ô`:v>0?`${v} d…ôqiq…ô ${M} saniy…ô`:`${M} saniy…ô`},oe=async()=>{try{const m=await(await fetch(`/api/chat-limits?t=${Date.now()}`,{cache:"no-store"})).json();Me(m),m.allowed?(De(!1),(nt||n?.user)&&X(!1)):(De(!0),X(!0),m.reset_time&&Ie(new Date(m.reset_time)))}catch(r){console.error("Failed to fetch limits:",r)}};l.useEffect(()=>{if(n?.user)X(!1),_e(!0);else{const r=JSON.parse(localStorage.getItem("guestChatSessions")||"[]");S(r),localStorage.getItem("guest-terms-accepted")==="true"?(_e(!0),X(!1)):(Se(!0),X(!0))}oe()},[n?.user]),l.useEffect(()=>{oe();const r=setInterval(oe,3e4),m=setInterval(()=>{te&&te-new Date<=0&&(oe(),Ie(null))},1e3);return()=>{clearInterval(r),clearInterval(m)}},[te]),l.useEffect(()=>{const r=()=>{u&&u(),oe()};return window.addEventListener("focus",r),()=>window.removeEventListener("focus",r)},[u]),l.useEffect(()=>{const r=setTimeout(()=>{$e(!!n?.user),setTimeout(()=>{const c=document.querySelector("#chat-container, [data-chat-background]");c&&!c.style.backgroundImage&&!c.style.background&&(console.log("Chat background retry - first attempt may have failed"),$e(!!n?.user))},1e3)},500),m=c=>{if(c.detail&&c.detail.background){const g=document.querySelector("#chat-container, [data-chat-background]");g&&(c.detail.type==="image"?(g.style.backgroundImage=c.detail.background,g.style.backgroundSize=c.detail.imageSize||"cover",g.style.backgroundPosition=c.detail.imagePosition||"center",g.style.backgroundRepeat="no-repeat",g.style.backgroundColor=""):(g.style.backgroundImage="",g.style.backgroundSize="",g.style.backgroundPosition="",g.style.backgroundRepeat="",c.detail.type==="gradient"?(g.style.background=c.detail.background,g.style.backgroundColor=""):c.detail.type==="solid"?(g.style.setProperty("background","none","important"),g.style.setProperty("background-image","none","important"),g.style.setProperty("background-size","auto","important"),g.style.setProperty("background-position","0% 0%","important"),g.style.setProperty("background-repeat","repeat","important"),g.style.setProperty("background-attachment","scroll","important"),g.style.setProperty("background-origin","padding-box","important"),g.style.setProperty("background-clip","border-box","important"),g.style.setProperty("background-color",c.detail.background,"important"),console.log("Chat listener applied solid color:",c.detail.background)):(g.style.backgroundColor=c.detail.background,g.style.background="")))}setTimeout(()=>$e(!!n?.user),200)};return window.addEventListener("backgroundChanged",m),()=>{clearTimeout(r),window.removeEventListener("backgroundChanged",m)}},[n?.user]);const Oe=(r,m,c)=>{if(!n?.user){const g={session_id:r,title:m||r.slice(0,8),messages:c||[],created_at:new Date().toISOString()},v=JSON.parse(localStorage.getItem("guestChatSessions")||"[]"),M=v.findIndex(Q=>Q.session_id===r);M>=0?v[M]={...v[M],messages:c}:v.unshift(g);const D=v.slice(0,10);localStorage.setItem("guestChatSessions",JSON.stringify(D)),S(D)}},ht=async r=>{if(n?.user)try{const{data:m}=await R.get(`/chat/${r}`);k(m.messages)}catch(m){t.error("S√∂hb…ôt y√ºkl…ônm…ôdi"),console.error("loadSession error:",m)}else{const m=d.find(c=>c.session_id===r);m&&k(m.messages||[])}b(r)},bt=()=>{localStorage.setItem("guest-terms-accepted","true"),_e(!0),ee||X(!1),Se(!1),t.success("ƒ∞stifad…ô ≈ü…ôrtl…ôri q…ôbul edildi! ƒ∞ndi √ßatbotla danƒ±≈üa bil…ôrsiniz.")},ft=()=>{Se(!1),X(!0),t.warning("ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul etm…ôd…ôn √ßatbotla danƒ±≈üa bilm…ôzsiniz.")},Ue=async()=>{if(!z.trim())return;if(E){t.warning("√áatbot h…ôl…ô d…ô yazƒ±r. Z…ôhm…ôt olmasa g√∂zl…ôyin.");return}if(F){t.warning("ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul etm…ôd…ôn mesaj g√∂nd…ôr…ô bilm…ôzsiniz.");return}if(Y){t.warning(`Daxiletm…ô limiti: ${K}. Cari: ${ae} simvol`);return}const r={role:"user",content:z,created_at:new Date().toISOString()};k(c=>[...c,{...r,id:`local-${Date.now()}`}]),L("");try{V.current&&(V.current.style.height="")}catch{}$(!0),i(!0);const m=new AbortController;je(m);try{const{data:c}=await R.post("/chat/send",{message:r.content,session_id:j},{signal:m.signal});if(!j){b(c.session_id);const D=r.content.slice(0,40),Q=new Date().toISOString();if(n?.user){U(le=>[{session_id:c.session_id,title:"",created_at:Q},...le]);let ne=0;const ie=setInterval(()=>{ne++;const le=D.slice(0,ne);U(de=>de.map(ce=>ce.session_id===c.session_id?{...ce,title:le}:ce)),ne>=D.length&&clearInterval(ie)},Math.max(20,Math.min(80,1e3/Math.max(5,D.length))))}else{const ne={session_id:c.session_id,title:"",created_at:Q,messages:[r]};S(de=>[ne,...de]);let ie=0;const le=setInterval(()=>{ie++;const de=D.slice(0,ie);S(ce=>ce.map(Le=>Le.session_id===c.session_id?{...Le,title:de}:Le)),ie>=D.length&&clearInterval(le)},Math.max(20,Math.min(80,1e3/Math.max(5,D.length))))}}const g=`ai-${Date.now()}`;let v;if(He==="instant"){v={role:"assistant",content:c.message,fullContent:c.message,id:g,created_at:new Date().toISOString(),isTyping:!1};const D=[...P,r,v];k(Q=>[...Q,v])}else v={role:"assistant",content:"",fullContent:c.message,id:g,created_at:new Date().toISOString(),isTyping:!0},k(D=>[...D,v]),Z(!0),setTimeout(()=>{ve(D=>new Set([...D,g]))},xt);const M=[...P,r,v];if(!n?.user){const D=j||c.session_id;Oe(D,r.content,M)}c.limit_info&&Me({allowed:c.limit_info.remaining>0,remaining:c.limit_info.remaining,daily_remaining:c.limit_info.daily_remaining,monthly_remaining:c.limit_info.monthly_remaining,reset_time:c.limit_info.reset_time,monthly_reset_time:c.limit_info.monthly_reset_time,user_type:n?.user?"user":"guest"})}catch(c){if(c.name==="CanceledError")t.info("Mesaj g√∂nd…ôrm…ô dayandƒ±rƒ±ldƒ±");else if(c.response?.status===429){const g=c.response.data;t.error(g.error||"Mesaj limiti dolmu≈üdur!"),g.limit_exceeded&&(De(!0),X(!0),g.reset_time&&Ie(new Date(g.reset_time)),Me({allowed:!1,remaining:g.remaining||0,daily_remaining:g.daily_remaining||0,monthly_remaining:g.monthly_remaining||0,reset_time:g.reset_time,monthly_reset_time:g.monthly_reset_time,user_type:n?.user?"user":"guest"}))}else t.error(c.response?.data?.error||"X…ôta ba≈ü verdi");Z(!1)}finally{$(!1),je(null),setTimeout(()=>{i(!1),He==="instant"&&Z(!1)},600),setTimeout(()=>q.current?.scrollTo({top:q.current.scrollHeight,behavior:"smooth"}),50)}},We=async()=>{Ee&&(Ee.abort(),je(null));try{await R.post("/chat/stop")}catch{}$(!1),i(!1),Z(!1),ve(new Set),t.info("Cavab yazmaq dayandƒ±rƒ±ldƒ±")},Xe=async(r,m,c)=>{st(r);try{et(v=>{const M=new Map(v);return M.set(r,c),M}),await R.post("/chat/feedback",{message_id:r,session_id:j,message_content:m,feedback_type:c});const g=c==="like"?"R…ôyiniz √º√ß√ºn t…ô≈ü…ôkk√ºr edirik, bu bizi sevindirir. :)":"R…ôyiniz √º√ß√ºn t…ô≈ü…ôkk√ºr edirik, biz √ßatbotu t…ôkmil…ô≈üdir…ôc…ôyik, z…ôif t…ôcr√ºb…ômiz √º√ß√ºn √ºzr ist…ôyirik.";t.success(g)}catch(g){console.error("Feedback error:",g);const v=g?.response?.data?.error||"B…ôy…ôn/B…ôy…ônm…ô g√∂nd…ôrilm…ôdi";t.error(v)}},kt=r=>{r.key==="Enter"&&W&&!r.shiftKey&&(r.preventDefault(),I||E?We():!F&&!E&&Ue())};return l.useEffect(()=>{q.current&&(q.current.scrollTop=q.current.scrollHeight)},[P]),l.useEffect(()=>{q.current&&q.current.scrollTo({top:q.current.scrollHeight,behavior:"smooth"})},[P]),l.useEffect(()=>{if(q.current&&E){const r=setInterval(()=>{try{const m=q.current;m.scrollTop=m.scrollHeight}catch{}},150);return()=>clearInterval(r)}},[E,P]),l.useEffect(()=>{const r=m=>{Ne.current&&!Ne.current.contains(m.target)&&ue(!1)};return document.addEventListener("click",r),()=>document.removeEventListener("click",r)},[]),e.jsx("div",{className:`${f.isDarkMode?"dark":""}`,children:e.jsxs("div",{className:"min-h-screen flex flex-col overflow-x-hidden",style:{background:f.isDarkMode?"linear-gradient(135deg, #1f2937 0%, #111827 100%)":w?.background_gradient||"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",backgroundAttachment:"fixed"},children:[e.jsx(Nt,{title:`∆èsas s…ôhif…ô - ${re}`}),e.jsxs("div",{className:"w-full px-4 md:px-4 lg:px-6 py-4 md:py-4 lg:py-6 flex-1 pb-0",children:[e.jsxs(N.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"mb-4 md:mb-6 flex flex-wrap items-center justify-between bg-gradient-to-r from-white/95 via-white/90 to-white/95 dark:from-gray-800/95 dark:via-gray-800/90 dark:to-gray-800/95 backdrop-blur-xl rounded-3xl p-4 md:p-6 shadow-2xl shadow-purple-500/10 dark:shadow-purple-500/20 w-full border border-white/20 dark:border-gray-700/50 hover:shadow-3xl transition-all duration-300",children:[e.jsxs(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},className:"flex items-start md:items-center gap-3",children:[e.jsx(N.button,{whileHover:{scale:1.05,rotate:5},whileTap:{scale:.95},onClick:()=>me(!we),className:"md:hidden p-3 rounded-xl bg-gradient-to-br from-purple-500/10 to-indigo-500/10 text-gray-700 dark:text-gray-300 hover:from-purple-500/20 hover:to-indigo-500/20 border border-purple-200/30 dark:border-purple-700/30 backdrop-blur-sm transition-all duration-300 shadow-lg hover:shadow-xl","aria-label":"S√∂hb…ôt tarix√ß…ôsi",children:e.jsx(y,{name:"menu",size:20})}),e.jsxs(N.h1,{initial:{opacity:0,x:-15},animate:{opacity:1,x:0},transition:{duration:.6,delay:.3},className:"hidden md:flex text-lg md:text-2xl lg:text-3xl font-bold bg-gradient-to-r from-gray-800 via-gray-700 to-gray-800 dark:from-gray-100 dark:via-gray-200 dark:to-gray-100 bg-clip-text text-transparent items-center gap-3 hover:from-purple-600 hover:via-indigo-600 hover:to-purple-600 transition-all duration-500",children:[a.brand_mode==="logo"&&(he||a.brand_logo_url)?e.jsx(N.img,{whileHover:{scale:1.1,rotate:5},src:he||a.brand_logo_url,alt:"logo",className:"w-8 h-8 md:w-10 md:h-10 object-contain rounded-xl shadow-lg border border-white/20 dark:border-gray-700/50"}):a.brand_mode==="icon"?e.jsx(N.div,{whileHover:{scale:1.1,rotate:5},className:"p-2 rounded-xl bg-gradient-to-br from-purple-500/10 to-indigo-500/10 border border-purple-200/30 dark:border-purple-700/30 shadow-lg",children:e.jsx(y,{name:a.brand_icon_name||"nav_chat",size:28,color:T})}):null,e.jsx(N.span,{whileHover:{scale:1.02},className:"truncate font-extrabold tracking-wide",children:re})]}),e.jsxs("div",{className:"md:hidden flex flex-col gap-1 ml-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[12px] font-medium text-gray-700 dark:text-gray-300",ref:Ne,children:[e.jsx(y,{name:"limit",size:18}),e.jsxs("span",{children:[A.limit_type==="monthly"?"Aylƒ±q":"G√ºnl√ºk"," limitiniz"]}),e.jsx("span",{className:"text-white px-2 py-0.5 rounded-full",style:{backgroundColor:T},children:A.remaining})," sorƒüu",e.jsx("button",{type:"button",onClick:r=>{r.stopPropagation(),Re(r.currentTarget),ue(m=>!m)},className:"ml-1 p-1 rounded-md text-gray-800 hover:text-black hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:scale-110",title:"Limit haqqƒ±nda",children:e.jsx(y,{name:"limit_info",size:18})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{name:"sun",size:16,color:f.isDarkMode?"#9ca3af":"#fbbf24"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f.isDarkMode,onChange:()=>f.toggleDarkMode(),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),e.jsx(y,{name:"moon",size:16,color:f.isDarkMode?"#60a5fa":"#9ca3af"})]})]})]}),e.jsxs(N.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.4},className:"hidden md:flex items-center gap-3 flex-wrap justify-end",children:[e.jsx(N.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:`relative px-4 py-2 rounded-xl text-xs font-semibold backdrop-blur-sm border shadow-lg transition-all duration-300 ${ee?"bg-gradient-to-r from-red-50 to-red-100 text-red-800 border-red-200 shadow-red-200/50":A.remaining<=5?"bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-800 border-yellow-200 shadow-yellow-200/50":"bg-gradient-to-r from-green-50 to-green-100 text-green-800 border-green-200 shadow-green-200/50"}`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{name:ee?"warning":"limit",size:12}),e.jsx("span",{children:ee?e.jsxs(e.Fragment,{children:["M…ôhdudiyy…ôt! - ",Ge(te)]}):e.jsxs(e.Fragment,{children:[A.limit_type==="monthly"?"Aylƒ±q":"G√ºnl√ºk"," limitiniz ",A.remaining," sorƒüu(√ßƒ±xƒ±≈ü)"]})}),e.jsx("button",{type:"button",onClick:r=>{r.stopPropagation(),Re(r.currentTarget),ue(m=>!m)},className:"ml-1 p-1 rounded-md text-gray-800 hover:text-black hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:scale-110",title:"Limit haqqƒ±nda",children:e.jsx(y,{name:"limit_info",size:18})})]})}),e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsx(y,{name:"sun",size:16,color:f.isDarkMode?"#9ca3af":"#fbbf24"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f.isDarkMode,onChange:()=>f.toggleDarkMode(),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),e.jsx(y,{name:"moon",size:16,color:f.isDarkMode?"#60a5fa":"#9ca3af"})]}),n?.user?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"hidden md:inline text-sm text-gray-600 dark:text-gray-300",children:["Salam, ",n.user.name]}),n.user.role?.name==="admin"&&e.jsx(N.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(B,{href:"/admin",className:"px-4 py-2.5 rounded-xl text-sm bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:from-purple-700 hover:to-indigo-700 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[e.jsx(y,{name:"settings",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Admin Panel"})]})}),e.jsx(N.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(B,{href:"/profile",className:"px-4 py-2.5 rounded-xl text-sm bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 hover:from-gray-200 hover:to-gray-300 dark:from-gray-600 dark:to-gray-700 dark:text-gray-200 dark:hover:from-gray-500 dark:hover:to-gray-600 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[e.jsx(y,{name:"users",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Profil"})]})}),e.jsx(N.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(B,{href:"/logout",method:"post",as:"button",className:"px-4 py-2.5 rounded-xl text-sm bg-gradient-to-r from-red-500 to-red-600 text-white hover:from-red-600 hover:to-red-700 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[e.jsx(y,{name:"logout",size:16}),e.jsx("span",{className:"hidden md:inline",children:"√áƒ±xƒ±≈ü"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(N.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(B,{href:"/login",className:"px-4 py-2.5 rounded-xl text-sm bg-white/80 backdrop-blur-sm border-2 text-emerald-700 hover:bg-emerald-50 hover:border-emerald-300 dark:bg-gray-800/80 dark:text-emerald-400 dark:hover:bg-gray-700 dark:border-gray-600 dark:hover:border-emerald-500 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",style:{borderColor:T},children:[e.jsx(y,{name:"users",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Daxil ol"})]})}),e.jsx(N.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(B,{href:"/register",className:"px-4 py-2.5 rounded-xl text-sm text-white font-medium transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 bg-gradient-to-r hover:scale-105",style:{background:`linear-gradient(135deg, ${T}DD, ${se||T}DD)`},children:[e.jsx(y,{name:"user_add",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Qeydiyyat"})]})})]}),e.jsxs(N.button,{whileHover:{scale:1.05,rotate:2},whileTap:{scale:.95},onClick:()=>{b(null),k([])},className:"px-4 py-2.5 rounded-xl text-sm text-white font-medium transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 bg-gradient-to-r hover:brightness-110",style:{background:`linear-gradient(135deg, ${se}DD, ${T||se}DD)`},children:[e.jsx(y,{name:"edit",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Yeni s√∂hb…ôt"})]})]}),e.jsxs("div",{className:"flex md:hidden items-center gap-2 ml-auto overflow-x-auto",children:[n?.user?e.jsxs(e.Fragment,{children:[n.user.role?.name==="admin"&&e.jsx(B,{href:"/admin",className:"px-2 py-2 rounded-lg text-sm bg-purple-600 text-white hover:bg-purple-700 transition-colors shadow-sm flex items-center gap-1",children:e.jsx(y,{name:"settings",size:16})}),e.jsx(B,{href:"/profile",className:"px-2 py-2 rounded-lg text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500 transition-colors shadow-sm flex items-center gap-1",children:e.jsx(y,{name:"users",size:16})}),e.jsx(B,{href:"/logout",method:"post",as:"button",className:"px-2 py-2 rounded-lg text-sm bg-red-500 text-white hover:bg-red-600 transition-colors shadow-sm flex items-center gap-1",children:e.jsx(y,{name:"logout",size:16})})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{href:"/login",className:"px-2 py-2 rounded-lg text-sm bg-white border text-emerald-700 hover:bg-emerald-50 dark:bg-gray-800 dark:text-emerald-400 dark:hover:bg-gray-700 transition-colors shadow-sm flex items-center gap-1",style:{borderColor:T},children:e.jsx(y,{name:"users",size:16})}),e.jsx(B,{href:"/register",className:"px-2 py-2 rounded-lg text-sm text-white transition-colors shadow-sm flex items-center gap-1",style:{backgroundColor:T},children:e.jsx(y,{name:"user_add",size:16})})]}),e.jsx("button",{onClick:()=>{b(null),k([])},className:"px-2 py-2 rounded-lg text-sm text-white transition-colors shadow-sm flex items-center gap-1",style:{backgroundColor:se},title:"Yeni s√∂hb…ôt",children:e.jsx(y,{name:"edit",size:16})})]})]}),e.jsxs("div",{className:"flex gap-0 md:gap-2 lg:gap-3",children:[we&&e.jsx("div",{className:"md:hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-40",onClick:()=>me(!1)}),e.jsx("aside",{className:`${we?"translate-x-0":"-translate-x-full"} md:translate-x-0 fixed md:relative top-0 left-0 z-50 md:z-auto w-80 md:w-[280px] lg:w-[300px] xl:w-[320px] h-full md:h-auto transform transition-transform duration-300 ease-in-out md:block md:flex-shrink-0`,children:e.jsxs("div",{className:"h-[80vh] md:h-[70vh] lg:h-[65vh] backdrop-blur-xl bg-white/95 dark:bg-gray-800/95 md:bg-white/90 md:dark:bg-gray-800/90 border-r md:border border-emerald-200 dark:border-gray-600 rounded-2xl overflow-hidden p-4 md:p-3 lg:p-3 shadow-2xl md:shadow-2xl hover:shadow-3xl dark:shadow-purple-500/10 transition-all duration-300 flex flex-col",style:{minWidth:"250px"},children:[e.jsxs("div",{className:"md:hidden flex items-center gap-2 mb-4 p-3 bg-white/50 dark:bg-gray-700/50 rounded-lg",children:[a.brand_mode==="logo"&&(he||a.brand_logo_url)?e.jsx("img",{src:he||a.brand_logo_url,alt:"logo",className:"w-5 h-5 object-contain rounded"}):a.brand_mode==="icon"?e.jsx(y,{name:a.brand_icon_name||"nav_chat",size:20,color:T}):null,e.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-100 truncate",children:re})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg md:text-xs lg:text-sm font-semibold md:font-medium uppercase tracking-wider text-gray-700 dark:text-gray-300 md:text-gray-600 md:dark:text-gray-400",children:"S√∂hb…ôt Tarix√ß…ôsi"}),e.jsx("button",{onClick:()=>me(!1),className:"md:hidden p-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(y,{name:"close",size:20})})]}),e.jsxs("div",{className:"space-y-2 max-h-[calc(80vh-8rem)] md:max-h-[calc(70vh-8rem)] lg:max-h-[calc(65vh-8rem)] overflow-auto pr-1 custom-scrollbar",children:[(n?.user?H:d).map(r=>e.jsxs("div",{className:`group relative flex items-center w-full rounded-lg text-gray-700 dark:text-gray-200 hover:bg-emerald-50 dark:hover:bg-gray-600 transition-colors ${j===r.session_id?"bg-emerald-100 dark:bg-gray-700 border-l-2":""}`,style:j===r.session_id?{borderLeftColor:T}:{},children:[e.jsxs("button",{onClick:()=>{ht(r.session_id),me(!1)},className:"flex-1 text-left px-2 py-2 md:py-2 text-xs md:text-sm",children:[e.jsx("div",{className:"truncate font-medium max-w-[180px] md:max-w-[200px]",children:r.title||r.session_id.slice(0,8)}),!n?.user&&r.created_at&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(r.created_at).toLocaleDateString("az")})]}),e.jsx("button",{onClick:m=>{m.stopPropagation(),Pe(r),Ce(!0)},className:"opacity-0 group-hover:opacity-100 transition-opacity px-2 py-2 text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg mr-1",title:"S√∂hb…ôti sil",children:e.jsx(y,{name:"close",size:14})})]},r.session_id)),(n?.user?H:d).length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(y,{name:"chat",size:48,color:f.isDarkMode?"#9ca3af":"#d1d5db",className:"mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Siz h…ôl…ô s√∂hb…ôt etm…ômisiniz"})]})]})]})}),e.jsx("div",{className:"flex-1 min-w-0 w-full",children:e.jsx("main",{className:"w-full max-w-none",children:e.jsxs("div",{className:`w-full backdrop-blur-xl border border-emerald-200 dark:border-gray-600 rounded-3xl p-3 md:p-6 flex flex-col shadow-2xl hover:shadow-3xl dark:shadow-purple-500/10 border-white/20 dark:border-gray-700/30 transition-all duration-300 relative ${Te==="transparent"?"bg-white/95 dark:bg-gray-800/95":""}`,"data-chat-background":"true",id:"chat-container",style:{minHeight:"calc(100vh - 200px)",background:Te!=="transparent"?Te:void 0,backgroundSize:w?.chat_background_type==="image"?"cover":void 0,backgroundPosition:w?.chat_background_type==="image"?"center":void 0,backgroundRepeat:w?.chat_background_type==="image"?"no-repeat":void 0},children:[e.jsxs("div",{className:"absolute top-2 right-2 z-20",children:[e.jsx("button",{onClick:()=>dt(r=>!r),className:"p-2 rounded-lg bg-white/80 dark:bg-gray-700/80 border border-gray-200 dark:border-gray-600 shadow hover:shadow-md transition",title:"M…ôtn √∂l√ß√ºs√º",children:e.jsx(y,{name:"type",size:16})}),lt&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 shadow-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"M…ôtn √∂l√ß√ºs√º"}),e.jsx("input",{type:"range",min:"0.85",max:"1.4",step:"0.05",value:O,onChange:r=>pe(parseFloat(r.target.value)),className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("button",{onClick:()=>pe(.95),className:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A-"}),e.jsx("button",{onClick:()=>pe(1),className:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A"}),e.jsx("button",{onClick:()=>pe(1.2),className:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A+"})]})]})]}),e.jsxs("div",{ref:q,className:"flex-1 overflow-y-auto space-y-3 pr-1 md:pr-2 custom-scrollbar",style:{maxHeight:"calc(100vh - 240px)"},children:[e.jsx(ge,{children:P.map((r,m)=>e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.2},className:`group relative max-w-[90%] md:max-w-[85%] rounded-xl px-3 md:px-4 py-2 md:py-3 ${r.role==="user"?"ml-auto bg-emerald-50/60 dark:bg-emerald-900/20":"mr-auto bg-gray-100/60 dark:bg-gray-700/50"} shadow-lg hover:shadow-xl dark:shadow-2xl dark:hover:shadow-3xl border border-emerald-100 dark:border-gray-600 backdrop-blur-md transition-all duration-300 hover:-translate-y-0.5`,style:{},children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:r.role==="user"?e.jsx("div",{className:"flex items-center gap-2",children:n?.user?e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:T},children:n.user.name}):e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:T},children:"Siz - Qonaq"})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:se},children:Fe||"AI Assistant"}),e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",title:"AI Aktiv"})]})}),r.created_at&&e.jsxs("div",{className:"text-xs text-gray-400 flex flex-col items-end",children:[e.jsx("span",{className:"hidden md:block",children:new Date(r.created_at).toLocaleDateString("az-AZ",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsx("span",{children:new Date(r.created_at).toLocaleTimeString("az-AZ",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"absolute top-1.5 right-1.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>ct(Be===(r.id||m)?null:r.id||m),className:"p-1.5 rounded-full bg-white/90 dark:bg-gray-800/90 border border-gray-200 dark:border-gray-600 shadow",title:"Mesaj m…ôtni √∂l√ß√ºs√º",children:e.jsx(y,{name:"type",size:12})}),Be===(r.id||m)&&e.jsxs("div",{className:"absolute right-0 mt-2 w-44 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 shadow-lg p-3 z-10",children:[e.jsx("div",{className:"text-[11px] font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bu mesaj √º√ß√ºn √∂l√ß√º"}),e.jsx("input",{type:"range",min:"0.85",max:"1.4",step:"0.05",value:ze.get(r.id)??O,onChange:c=>{const g=parseFloat(c.target.value);xe(v=>{const M=new Map(v);return M.set(r.id,g),M})},className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("button",{onClick:()=>xe(c=>{const g=new Map(c);return g.set(r.id,Math.max(.85,(g.get(r.id)??O)-.05)),g}),className:"px-2 py-1 text-[11px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A-"}),e.jsx("button",{onClick:()=>xe(c=>{const g=new Map(c);return g.set(r.id,O),g}),className:"px-2 py-1 text-[11px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"Sƒ±fƒ±rla"}),e.jsx("button",{onClick:()=>xe(c=>{const g=new Map(c);return g.set(r.id,Math.min(1.4,(g.get(r.id)??O)+.05)),g}),className:"px-2 py-1 text-[11px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A+"})]})]})]}),e.jsx("div",{className:"whitespace-pre-wrap leading-relaxed text-gray-800 dark:text-gray-200",style:{fontSize:`${ze.get(r.id)??O}rem`},children:r.role==="assistant"?Ve.has(r.id)?e.jsx(Wt,{text:r.fullContent,speed:pt,onComplete:()=>{k(c=>{const g=c.map(v=>v.id===r.id?{...v,content:r.fullContent,isTyping:!1}:v);return!n?.user&&j&&setTimeout(()=>{Oe(j,null,g)},100),g}),ve(c=>{const g=new Set(c);return g.delete(r.id),g}),Z(!1)}}):e.jsx(Xt,{content:r.content||""}):e.jsx("div",{className:"whitespace-pre-wrap",style:{fontSize:`${ze.get(r.id)??O}rem`},children:r.content})}),r.role==="assistant"&&!r.isTyping&&e.jsxs("div",{className:"flex items-center justify-start md:justify-between mt-2 flex-wrap gap-1 md:gap-2",children:[(()=>{const c=String(r.id||"");return!(qe.has(c)||J.has(r.id))})()&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Xe(String(r.id||""),r.content||r.fullContent,"like"),disabled:J.has(r.id),className:`p-1 md:p-1.5 rounded-lg transition-all group/btn ${J.get(r.id)==="like"?"text-green-600 bg-green-50 dark:bg-green-900/30":"text-gray-400 hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-900/30"} disabled:opacity-50`,title:"B…ôy…ôn",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{name:"heart",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:J.get(r.id)==="like"?"B…ôy…ôndiniz":"B…ôy…ôn"})]})}),e.jsx("button",{onClick:()=>Xe(String(r.id||""),r.content||r.fullContent,"dislike"),disabled:J.has(r.id),className:`p-1 md:p-1.5 rounded-lg transition-all group/btn ${J.get(r.id)==="dislike"?"text-red-600 bg-red-50 dark:bg-red-900/30":"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/30"} disabled:opacity-50`,title:"B…ôy…ônm…ô",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{name:"dislike",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:J.get(r.id)==="dislike"?"B…ôy…ônm…ôdiniz":"B…ôy…ônm…ô"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-75 hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r.content||r.fullContent),t.success("M…ôtn kopyalandƒ±!")},className:"p-1 md:p-1.5 text-gray-400 hover:text-emerald-500 hover:bg-emerald-50 rounded-lg transition-all group/btn",title:"M…ôtn kopyala",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{name:"copy",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:"Kopyala"})]})}),e.jsx("button",{onClick:()=>{t.success("Geribildiri≈üiniz g√∂nd…ôrilir..."),(async()=>{try{const g=r.id,v=g!=null?String(g):void 0,M={message_content:r.content||r.fullContent,session_id:j,timestamp:r.created_at,user_info:n?.user?{name:n.user.name,email:n.user.email}:"Qonaq istifad…ô√ßi"};v!==void 0&&(M.message_id=v);const D=await R.post("/chat/report-feedback",M);setTimeout(()=>{t.success("Geribildiri≈üiniz g√∂nd…ôrildi!")},1e3)}catch(g){console.error("Feedback report error:",g);const v=g.response?.data?.message||g.response?.data?.error||"X…ôta ba≈ü verdi";setTimeout(()=>{t.error("Geribildiri≈ü g√∂nd…ôrilm…ôdi: "+v)},1e3)}})()},className:"p-1 md:p-1.5 text-gray-400 hover:text-orange-500 hover:bg-orange-50 rounded-lg transition-all group/btn",title:"S…ôhv cavab haqqƒ±nda bildi≈ü g√∂nd…ôr",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{name:"warning",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:"Bildir"})]})})]})]})]},r.id||m))}),s&&e.jsx(Ht,{chatbotName:Fe})]}),e.jsx("div",{className:"mt-3 md:mt-4",children:e.jsx("div",{className:"relative bg-white/50 dark:bg-gray-800/50 backdrop-blur-lg rounded-2xl border border-white/30 dark:border-gray-700/30 shadow-2xl hover:shadow-3xl transition-all duration-300 p-1",children:e.jsxs("div",{className:"relative flex items-end gap-2",children:[e.jsx("textarea",{ref:V,className:`flex-1 bg-transparent border-none outline-none focus:outline-none focus:ring-0 resize-none text-sm md:text-base p-3 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-gray-100 min-h-[50px] max-h-[150px] ${ye&&Y?"text-red-600 placeholder-red-400":""} ${F||E?"opacity-50 cursor-not-allowed":""}`,placeholder:ee?`Limit doldu - ${Ge(te)}`:E?"√áatbot yazƒ±r... g√∂zl…ôyin":F?"ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul edin...":"Mesajƒ±nƒ±zƒ± yazƒ±n...",value:z,onChange:r=>{if(!F&&!E){const m=r.target.value;L(K>0?m.slice(0,K):m)}try{const m=V.current;if(m){m.style.height="auto";const c=(window.innerWidth<768,150);m.style.height=Math.min(m.scrollHeight,c)+"px"}}catch{}},onInput:()=>{try{const r=V.current;if(r){r.style.height="auto";const m=(window.innerWidth<768,150);r.style.height=Math.min(r.scrollHeight,m)+"px"}}catch{}},onKeyDown:kt,disabled:F,rows:2}),e.jsxs("div",{className:"flex items-center gap-1 pb-3 pr-1",children:[e.jsx("button",{onClick:()=>ke(!W),className:`p-2 rounded-lg transition-all shadow-sm hover:shadow-md border backdrop-blur-sm ${W?"bg-emerald-500/90 text-white border-emerald-400/50 shadow-emerald-500/25":"bg-white/70 dark:bg-gray-700/70 text-gray-600 dark:text-gray-300 border-gray-300/50 dark:border-gray-600/50"}`,title:W?"Enter il…ô g√∂nd…ôr aktiv":"Enter il…ô g√∂nd…ôr deaktiv",children:e.jsx(y,{name:"enter",size:14})}),e.jsx("button",{onClick:()=>I||E?We():Ue(),disabled:ye&&Y||F,className:"p-3 rounded-xl text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-all shadow-lg hover:shadow-xl hover:scale-105 backdrop-blur-sm",style:{backgroundColor:I||E||ye&&Y||F?"#ef4444":T,boxShadow:`0 4px 20px ${I||E?"#ef444420":`${T}20`}`},title:I||E?"Dayandƒ±r":F?"ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul edin":"G√∂nd…ôr",children:e.jsx(y,{name:I||E?"stop":F?"shield_check":"send",size:16})})]})]})})}),ye&&e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("p",{className:`text-xs transition-all ${Y?"text-red-600 font-medium":yt<50?"text-yellow-600":"text-gray-500"}`,children:["Daxiletm…ô limiti ",K," simvol",ae>0&&e.jsxs("span",{className:Y?"text-red-600":"text-gray-400",children:["(istifad…ô edilib: ",ae,")"]})]}),Y&&e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"‚ö†Ô∏è Limit ke√ßildi!"})]}),e.jsx("div",{className:"text-center mt-3",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 px-4 py-2 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg inline-block",children:["‚ö†Ô∏è ",ut]})}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 text-center",children:W?e.jsxs("span",{children:[e.jsx("strong",{className:"text-gray-600 dark:text-gray-300",children:"Enter"})," - g√∂nd…ôr, ",e.jsx("strong",{className:"text-gray-600 dark:text-gray-300",children:"Shift+Enter"})," - yeni s…ôtir"]}):e.jsxs("span",{children:[e.jsx("strong",{className:"text-gray-600 dark:text-gray-300",children:"Enter"})," - yeni s…ôtir"]})})]})})})]})]}),e.jsx(St,{footerSettings:p}),e.jsx(qt,{}),e.jsx(Bt,{isOpen:ot,onAccept:bt,onReject:ft,siteName:re}),tt&&It.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999]",onClick:()=>ue(!1),children:[e.jsx("div",{className:"absolute inset-0"}),e.jsxs("div",{className:"absolute w-[18rem] md:w-[20rem] p-3 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-2xl text-xs text-gray-700 dark:text-gray-200 limit-popover-animate backdrop-blur-lg",style:{top:Ae.top,left:Ae.left},onClick:r=>r.stopPropagation(),children:[e.jsx("div",{className:"font-semibold mb-1",children:"Limit qaydasƒ±"}),A.limit_type==="monthly"?e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:"Aylƒ±q limit 30 g√ºnd…ôn bir b…ôrpa olunur. ƒ∞lk mesaj g√∂nd…ôrdiyiniz vaxt ba≈ülanƒüƒ±c n√∂qt…ôsidir."}),e.jsx("p",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"N√ºmun…ô: ƒ∞lk mesajƒ± bu g√ºn 14:00-da g√∂nd…ôrmisinizs…ô, n√∂vb…ôti b…ôrpa 30 g√ºn sonra eyni tarix v…ô saatda olacaq."}),e.jsxs("p",{className:"mt-1",children:["N√∂vb…ôti b…ôrpa: ",A.monthly_reset_time?new Date(A.monthly_reset_time).toLocaleString("az-AZ"):"H…ôl…ô ba≈ülanmayƒ±b"]})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:"G√ºnl√ºk limit yalnƒ±z 0-a d√º≈üd√ºkd…ô 24 saatlƒ±q geri sayƒ±m ba≈ülayƒ±r."}),e.jsxs("p",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:["N√ºmun…ô: D√ºn…ôn 14:00-da istifad…ô etdiniz v…ô h…ôl…ô ",A.daily_remaining??A.remaining," qalƒ±bsa, sabah 14:00-da yenil…ônmir. 0 etdiyiniz andan 24 saat sonra b…ôrpa olacaq."]}),e.jsxs("p",{className:"mt-1",children:["N√∂vb…ôti b…ôrpa: ",A.reset_time?new Date(A.reset_time).toLocaleString("az-AZ"):"Limit bitm…ôyib"]})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"font-semibold mb-0.5",children:"‚ÄúSorƒüu‚Äù n…ôdir?"}),e.jsx("p",{children:"H…ôr g√∂nd…ôrdiyiniz mesaj 1 sorƒüudur."})]})]})]}),document.body),e.jsx(Ft,{isOpen:it,onConfirm:gt,onCancel:mt,chatTitle:G?.title||G?.session_id?.slice(0,8)||"",siteName:re}),e.jsx(Ot,{isAuthenticated:!!n?.user})]})})}export{sr as default};
